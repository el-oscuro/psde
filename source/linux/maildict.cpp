//*****************************************************************************           //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
//                                                                                        //09-03-10|0x000b
// MAILBOX DICTIONARY_MANAGER                                                             //09-03-10|0x000b
//                                                                                        //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
//  Copyright: 2006 Robert H. Adams                                                       //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
//  The purpose of this program as well as instructions regarding its use is              //09-03-10|0x000b
//  defined in the associated manual.                                                     //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
//  This program is free software; you can redistribute it and/or modify                  //09-03-10|0x000b
//  it under the terms of the GNU General Public License as published by                  //09-03-10|0x000b
//  the Free Software Foundation; either version 2 of the License, or                     //09-03-10|0x000b
//  (at your option) any later version.                                                   //09-03-10|0x000b
//                                                                                        //09-03-10|0x000b
//  This program is distributed in the hope that it will be useful,                       //09-03-10|0x000b
//  but WITHOUT ANY WARRANTY; without even the implied warranty of                        //09-03-10|0x000b
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                         //09-03-10|0x000b
//  GNU General Public License for more details.                                          //09-03-10|0x000b
//                                                                                        //09-03-10|0x000b
//  You should have received a copy of the GNU General Public License                     //09-03-10|0x000b
//  along with this program; if not, write to the Free Software                           //09-03-10|0x000b
//  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA., 02110-1301            //09-03-10|0x000b
//  USA                                                                                   //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
//  For further information, please contact Robert Adams:                                 //09-03-10|0x000b
//     EMail:    robert.adams@whatifwe.com                                                //09-03-10|0x000b
//     Mail:     PO Box 156, Sun Valley, Ca. 91353-0155, USA                              //09-03-10|0x000b
//  Or visit the website, "www.whatifwe.com".                                             //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
//*****************************************************************************           //09-03-10|0x000b
#ifdef WIN31_SYSTEM                                                                       //05-24-97|0x000c
#include "precwn31.h"                                                                     //05-24-97|0x000c
#endif                                                                                    //05-24-97|0x000c
#ifdef WIN95_SYSTEM                                                                       //05-24-97|0x000c
#include "precwn95.h"                                                                     //05-24-97|0x000c
#endif                                                                                    //05-24-97|0x000c
#ifdef MSDOS_SYSTEM                                                                       //05-24-97|0x000c
#include "precdos.h"                                                                      //05-24-97|0x000c
#endif                                                                                    //05-24-97|0x000c
#include "prechost.h"                                                                     //05-24-97|0x000c
#include "maildict.h"                                                                     //09-03-10|0x000c
#include "maildict.hxx"                                                                   //09-03-10|0x000c
#include "maildict.hpp"                                                                   //09-03-10|0x000c
#include "precutil.h"                                                                     //09-03-10|0x000d
#include "precdiag.h"                                                                     //09-03-10|0x000e
#include "precfile.h"                                                                     //09-03-10|0x000f
#include "basedict.h"                                                                     //09-03-10|0x0010
#include "global.hxx"                                                                     //09-03-10|0x0011
#define StrLen(i) strlen(i)                                                               //09-03-10|0x0019
#define StrCat(i,j) strcat(i,j)                                                           //09-03-10|0x0019
#define StrCpy(i,j) strcpy(i,j)                                                           //09-03-10|0x0019
#define StrCmp(i,j) Str_Comp((SCHAR_FAR)i,j,256)                                          //09-03-10|0x0019
#define StrRChr(i,j) strrchr(i,j)                                                         //09-03-10|0x0019
#define StrChr(i,j) strchr(i,j)                                                           //09-03-10|0x0019
#define StrToByteInt(i,j) GetInteger(i,&j,0xff)                                           //09-03-10|0x0019
#define StrToInt(i,j) GetInteger(i,&j,0xffff)                                             //09-03-10|0x0019
#define StrToLongInt(i,j) GetInteger(i,&j,0xffffffffL)                                    //09-03-10|0x0019
#define StrToByteHex(i,j) GetHex(i,&j,1)                                                  //09-03-10|0x0019
#define StrToHex(i,j) GetHex(i,&j,2)                                                      //09-03-10|0x0019
#define StrToLongHex(i,j) GetHex(i,&j,4)                                                  //09-03-10|0x0019
#define FindName(i) strrchr(i, '/')                                                       //09-03-10|0x0019
#define Allocate(k) (k##_FAR) calloc(1,sizeof(k))                                         //09-03-10|0x001a
#define Free(k) free(k)                                                                   //09-03-10|0x001a
#define MemSet(i,j,k) memset(i,j,k)                                                       //09-03-10|0x001a
#define MemCCpy(i,j,k,l) Mem_C_Copy((UCHAR_FAR) i, (UCHAR_FAR) j,k,l)                     //09-03-10|0x001a
#define MemCpy(i,j,k) memcpy(i,j,k)                                                       //09-03-10|0x001a
#define LineEnd 0x0d                                                                      //09-03-10|0x001a
MAILDICT mail_dict;                                                                       //09-03-10|0x0043
static UINT test_samples[TestIndex];                                                      //09-03-10|0x0053
//***************************************************************************             //09-03-10|0x0065
//***************************************************************************             //09-03-10|0x0066
//******                                                               ******             //09-03-10|0x0067
//******                       mail_dict_allocate                      ******             //09-03-10|0x0068
//******                                                               ******             //09-03-10|0x0069
//***************************************************************************             //09-03-10|0x006a
//***************************************************************************             //09-03-10|0x006b
//*******************************************************************************         //10-29-97|0x0072
//*******************************************************************************         //10-29-97|0x0072
// mail_dict_allocate                                                                     //09-03-10|0x0072
//*******************************************************************************         //10-29-97|0x0072
//*******************************************************************************         //10-29-97|0x0072
UINT MAILDICT::mail_dict_allocate(void) {                                                 //09-03-10|0x0072
//*******************************************************************************         //10-29-97|0x0072
//***************************************************************************             //09-03-10|0x0076
//***************************************************************************             //09-03-10|0x0077
    TestSample(mail_dict_allocate_1);                                                     //09-03-10|0x0078
    if(mail_dict_addr                              != 0)    ReturnSystemError             //09-03-10|0x0079
    if((mail_dict_addr = Allocate(MAIL_DICT_DATA)) == 0)    ReturnSystemError             //09-03-10|0x007a
//***************************************************************************             //09-03-10|0x007b
    return(Success);                                                                      //09-03-10|0x007c
}                                                                                         //09-03-10|0x007d
//                                                                                        //05-24-97|0x007d
//***************************************************************************             //09-03-10|0x0080
//***************************************************************************             //09-03-10|0x0081
//******                                                               ******             //09-03-10|0x0082
//******                         mail_dict_free                        ******             //09-03-10|0x0083
//******                                                               ******             //09-03-10|0x0084
//***************************************************************************             //09-03-10|0x0085
//***************************************************************************             //09-03-10|0x0086
//*******************************************************************************         //10-29-97|0x008a
//*******************************************************************************         //10-29-97|0x008a
// mail_dict_free                                                                         //09-03-10|0x008a
//*******************************************************************************         //10-29-97|0x008a
//*******************************************************************************         //10-29-97|0x008a
UINT MAILDICT::mail_dict_free(void) {                                                     //09-03-10|0x008a
//*******************************************************************************         //10-29-97|0x008a
//***************************************************************************             //09-03-10|0x008e
//***************************************************************************             //09-03-10|0x008f
    TestSample(mail_dict_free_1);                                                         //09-03-10|0x0090
    if(mail_dict_addr                 == 0)                 ReturnSystemError             //09-03-10|0x0091
    Free(mail_dict_addr);                                                                 //09-03-10|0x0092
    mail_dict_addr = 0;                                                                   //09-03-10|0x0093
//***************************************************************************             //09-03-10|0x0094
    return(Success);                                                                      //09-03-10|0x0095
}                                                                                         //09-03-10|0x0096
//                                                                                        //05-24-97|0x0096
//***************************************************************************             //10-01-03|0x0099
//***************************************************************************             //10-01-03|0x009a
//******                                                               ******             //10-01-03|0x009b
//******               mail_dict_initial(Name, Extent)                 ******             //10-01-03|0x009c
//******                                                               ******             //10-01-03|0x009d
//***************************************************************************             //10-01-03|0x009e
//***************************************************************************             //10-01-03|0x009f
//*******************************************************************************         //10-29-97|0x00a4
//*******************************************************************************         //10-29-97|0x00a4
// mail_dict_initial                                                                      //10-01-03|0x00a4
//*******************************************************************************         //10-29-97|0x00a4
//*******************************************************************************         //10-29-97|0x00a4
UINT MAILDICT::mail_dict_initial(                                                         //10-01-03|0x00a4
    SCHAR_FAR Name,                                                                       //10-01-03|0x00a4
    SCHAR_FAR Extent                                                                      //10-01-03|0x00a4
    ) {                                                                                   //10-01-03|0x00a4
//*******************************************************************************         //10-29-97|0x00a4
//***************************************************************************             //10-01-03|0x00a8
//***************************************************************************             //10-01-03|0x00a9
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x00aa
//***************************************************************************             //10-01-03|0x00ab
    if(MailState      != START_STATE)                       ReturnSystemError             //10-01-03|0x00ac
    MailState         =  ADD_MAIL_BOX_NAME;                                               //10-01-03|0x00ad
//***************************************************************************             //10-01-03|0x00ae
    MailSize          =  sizeof(MAIL_DICT_CONTROL);                                       //10-01-03|0x00af
    MailIndex         =  -1;                                                              //10-01-03|0x00b0
//***************************************************************************             //10-01-03|0x00b1
    switch(FileInitialBinary(MailFileAddr))                      _SwitchGroup             //10-01-03|0x00b2
    switch(FileEnterName(Name,  Extent))                         _SwitchGroup             //10-01-03|0x00b3
    switch(FileCreateRecord())                                   _SwitchGroup             //10-01-03|0x00b4
    switch(FileRelease())                                        _SwitchGroup             //10-01-03|0x00b5
//***************************************************************************             //10-01-03|0x00b6
    return_test(mail_dict_initial_1);                                                     //10-01-03|0x00b7
}                                                                                         //10-01-03|0x00b8
//                                                                                        //05-24-97|0x00b8
//***************************************************************************             //10-01-03|0x00bb
//***************************************************************************             //10-01-03|0x00bc
//******                                                               ******             //10-01-03|0x00bd
//******               mail_dict_name(Name, Extent)                    ******             //10-01-03|0x00be
//******                                                               ******             //10-01-03|0x00bf
//***************************************************************************             //10-01-03|0x00c0
//***************************************************************************             //10-01-03|0x00c1
//*******************************************************************************         //10-29-97|0x00c6
//*******************************************************************************         //10-29-97|0x00c6
// mail_dict_name                                                                         //10-01-03|0x00c6
//*******************************************************************************         //10-29-97|0x00c6
//*******************************************************************************         //10-29-97|0x00c6
UINT MAILDICT::mail_dict_name(                                                            //10-01-03|0x00c6
    SINT Index,                                                                           //10-01-03|0x00c6
    SCHAR_FAR Name                                                                        //10-01-03|0x00c6
    ) {                                                                                   //10-01-03|0x00c6
//*******************************************************************************         //10-29-97|0x00c6
//***************************************************************************             //10-01-03|0x00ca
//***************************************************************************             //10-01-03|0x00cb
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x00cc
    if(MailState      !=  ADD_MAIL_BOX_NAME)                ReturnSystemError             //10-01-03|0x00cd
//***************************************************************************             //10-01-03|0x00ce
    MemSet(MailDataAddr,  0, MailSize);                                                   //10-01-03|0x00cf
    if(MemCCpy(MailPathAddr,  Name, 0, _MAX_PATH) == 0)     ReturnSystemError             //10-01-03|0x00d0
//***************************************************************************             //10-01-03|0x00d1
    switch(mail_dict_control_write(Index))                       _SwitchGroup             //10-01-03|0x00d2
    return_test(mail_dict_name_1);                                                        //10-01-03|0x00d3
}                                                                                         //10-01-03|0x00d4
//                                                                                        //05-24-97|0x00d4
//***************************************************************************             //10-01-03|0x00d7
//***************************************************************************             //10-01-03|0x00d8
//******                                                               ******             //10-01-03|0x00d9
//******               mail_dict_name_done()                           ******             //10-01-03|0x00da
//******                                                               ******             //10-01-03|0x00db
//***************************************************************************             //10-01-03|0x00dc
//***************************************************************************             //10-01-03|0x00dd
//*******************************************************************************         //10-29-97|0x00e2
//*******************************************************************************         //10-29-97|0x00e2
// mail_dict_name_done                                                                    //10-01-03|0x00e2
//*******************************************************************************         //10-29-97|0x00e2
//*******************************************************************************         //10-29-97|0x00e2
UINT MAILDICT::mail_dict_name_done(void) {                                                //10-01-03|0x00e2
//*******************************************************************************         //10-29-97|0x00e2
//***************************************************************************             //10-01-03|0x00e6
//***************************************************************************             //10-01-03|0x00e7
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x00e8
    if(MailState      != ADD_MAIL_BOX_NAME)                 ReturnSystemError             //10-01-03|0x00e9
    MailState         =  MAIL_BOX_FILE_DATE;                                              //10-01-03|0x00ea
//***************************************************************************             //10-01-03|0x00eb
    MailIndex         =  -1;                                                              //10-01-03|0x00ec
//***************************************************************************             //10-01-03|0x00ed
    return_test(mail_dict_date_done_1);                                                   //10-01-03|0x00ee
}                                                                                         //10-01-03|0x00ef
//                                                                                        //05-24-97|0x00ef
//***************************************************************************             //10-01-03|0x00f2
//***************************************************************************             //10-01-03|0x00f3
//******                                                               ******             //10-01-03|0x00f4
//******               mail_dict_exists(TimeAddr)                      ******             //10-01-03|0x00f5
//******                                                               ******             //10-01-03|0x00f6
//***************************************************************************             //10-01-03|0x00f7
//***************************************************************************             //10-01-03|0x00f8
//*******************************************************************************         //10-29-97|0x00fe
//*******************************************************************************         //10-29-97|0x00fe
// mail_dict_exists                                                                       //10-01-03|0x00fe
//*******************************************************************************         //10-29-97|0x00fe
//*******************************************************************************         //10-29-97|0x00fe
UINT MAILDICT::mail_dict_exists(                                                          //10-01-03|0x00fe
    SINT Index,                                                                           //10-01-03|0x00fe
    ULONG_FAR TimeFar                                                                     //10-01-03|0x00fe
    ) {                                                                                   //10-01-03|0x00fe
//*******************************************************************************         //10-29-97|0x00fe
//***************************************************************************             //10-01-03|0x0102
//***************************************************************************             //10-01-03|0x0103
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x0104
    if(MailState      !=  MAIL_BOX_FILE_DATE)               ReturnSystemError             //10-01-03|0x0105
//***************************************************************************             //10-01-03|0x0106
    switch(mail_dict_control_read(Index))                        _SwitchGroup             //10-01-03|0x0107
//***************************************************************************             //10-01-03|0x0108
    switch(BaseDictInitial(MailDictAddr, MailPathAddr, MBX_EXTENT))                       //10-01-03|0x0109
                                                                 _SwitchGroup             //10-01-03|0x010a
//***************************************************************************             //10-01-03|0x010b
    switch(BaseDictExists(MailDictAddr, TimeFar))                _SwitchGroup             //10-01-03|0x010c
//***************************************************************************             //10-01-03|0x010d
    return_test(mail_dict_exists_1);                                                      //10-01-03|0x010e
}                                                                                         //10-01-03|0x010f
//                                                                                        //05-24-97|0x010f
//***************************************************************************             //10-01-03|0x0112
//***************************************************************************             //10-01-03|0x0113
//******                                                               ******             //10-01-03|0x0114
//******               mail_dict_date_done()                           ******             //10-01-03|0x0115
//******                                                               ******             //10-01-03|0x0116
//***************************************************************************             //10-01-03|0x0117
//***************************************************************************             //10-01-03|0x0118
//*******************************************************************************         //10-29-97|0x011d
//*******************************************************************************         //10-29-97|0x011d
// mail_dict_date_done                                                                    //10-01-03|0x011d
//*******************************************************************************         //10-29-97|0x011d
//*******************************************************************************         //10-29-97|0x011d
UINT MAILDICT::mail_dict_date_done(void) {                                                //10-01-03|0x011d
//*******************************************************************************         //10-29-97|0x011d
//***************************************************************************             //10-01-03|0x0121
//***************************************************************************             //10-01-03|0x0122
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x0123
    if(MailState      !=  MAIL_BOX_FILE_DATE)               ReturnSystemError             //10-01-03|0x0124
    MailState         =  MAIL_BOX_FILE_READY;                                             //10-01-03|0x0125
//***************************************************************************             //10-01-03|0x0126
    MailIndex         =  -1;                                                              //10-01-03|0x0127
//***************************************************************************             //10-01-03|0x0128
    return_test(mail_dict_date_done_1);                                                   //10-01-03|0x0129
}                                                                                         //10-01-03|0x012a
//                                                                                        //05-24-97|0x012a
//***************************************************************************             //10-01-03|0x012d
//***************************************************************************             //10-01-03|0x012e
//******                                                               ******             //10-01-03|0x012f
//******               mail_dict_create(index)                         ******             //10-01-03|0x0130
//******                                                               ******             //10-01-03|0x0131
//***************************************************************************             //10-01-03|0x0132
//***************************************************************************             //10-01-03|0x0133
//*******************************************************************************         //10-29-97|0x0138
//*******************************************************************************         //10-29-97|0x0138
// mail_dict_create                                                                       //10-01-03|0x0138
//*******************************************************************************         //10-29-97|0x0138
//*******************************************************************************         //10-29-97|0x0138
UINT MAILDICT::mail_dict_create(                                                          //10-01-03|0x0138
    SINT Index                                                                            //10-01-03|0x0138
    ) {                                                                                   //10-01-03|0x0138
//*******************************************************************************         //10-29-97|0x0138
//***************************************************************************             //10-01-03|0x013c
//***************************************************************************             //10-01-03|0x013d
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x013e
    if(MailState      !=  MAIL_BOX_FILE_READY)              ReturnSystemError             //10-01-03|0x013f
//***************************************************************************             //10-01-03|0x0140
    switch(mail_dict_control_read(Index))                        _SwitchGroup             //10-01-03|0x0141
//***************************************************************************             //10-01-03|0x0142
    switch(BaseDictInitial(MailDictAddr, MailPathAddr, MBX_EXTENT))                       //10-01-03|0x0143
                                                                 _SwitchGroup             //10-01-03|0x0144
//***************************************************************************             //10-01-03|0x0145
    switch(BaseDictInitialHash(MailDictAddr))                    _SwitchGroup             //10-01-03|0x0146
//***************************************************************************             //10-04-30|0x0147
    MailState         =  MAIL_BOX_FILE_OPENED;                                            //10-04-30|0x0148
//***************************************************************************             //10-01-03|0x0149
    return_test(mail_dict_create_1);                                                      //10-01-03|0x014a
}                                                                                         //10-01-03|0x014b
//                                                                                        //05-24-97|0x014b
//***************************************************************************             //10-01-03|0x014e
//***************************************************************************             //10-01-03|0x014f
//******                                                               ******             //10-01-03|0x0150
//******               mail_dict_read(Index)                           ******             //10-01-03|0x0151
//******                                                               ******             //10-01-03|0x0152
//***************************************************************************             //10-01-03|0x0153
//***************************************************************************             //10-01-03|0x0154
//*******************************************************************************         //10-29-97|0x0159
//*******************************************************************************         //10-29-97|0x0159
// mail_dict_read                                                                         //10-01-03|0x0159
//*******************************************************************************         //10-29-97|0x0159
//*******************************************************************************         //10-29-97|0x0159
UINT MAILDICT::mail_dict_read(                                                            //10-01-03|0x0159
    SINT Index                                                                            //10-01-03|0x0159
    ) {                                                                                   //10-01-03|0x0159
//*******************************************************************************         //10-29-97|0x0159
//***************************************************************************             //10-01-03|0x015d
//***************************************************************************             //10-01-03|0x015e
  ULONG mailbox_time;                                                                //10-01-03|0x015f
//***************************************************************************             //10-01-03|0x0160
//***************************************************************************             //10-01-03|0x0161
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x0162
    if(MailState      !=  MAIL_BOX_FILE_READY)              ReturnSystemError             //10-01-03|0x0163
//***************************************************************************             //10-01-03|0x0164
    switch(mail_dict_control_read(Index))                        _SwitchGroup             //10-01-03|0x0165
//***************************************************************************             //10-01-03|0x0166
    switch(BaseDictInitial(MailDictAddr, MailPathAddr, MBX_EXTENT))                       //10-01-03|0x0167
                                                                 _SwitchGroup             //10-01-03|0x0168
//***************************************************************************             //10-01-03|0x0169
    switch(BaseDictExists(MailDictAddr, &mailbox_time))          _SwitchGroup             //10-01-03|0x016a
    if(mailbox_time ==  0)                                  ReturnSystemError             //10-01-03|0x016b
//***************************************************************************             //10-01-03|0x016c
    switch(BaseDictReadHash(MailDictAddr))                       _SwitchGroup             //10-01-03|0x016d
//***************************************************************************             //10-04-30|0x016e
    MailState         =  MAIL_BOX_FILE_OPENED;                                            //10-04-30|0x016f
//***************************************************************************             //10-01-03|0x0170
    return_test(mail_dict_read_1);                                                        //10-01-03|0x0171
}                                                                                         //10-01-03|0x0172
//                                                                                        //05-24-97|0x0172
//***************************************************************************             //10-01-03|0x0175
//***************************************************************************             //10-01-03|0x0176
//******                                                               ******             //10-01-03|0x0177
//******                    mail_dict_open(Index)                      ******             //10-01-03|0x0178
//******                                                               ******             //10-01-03|0x0179
//***************************************************************************             //10-01-03|0x017a
//***************************************************************************             //10-01-03|0x017b
//*******************************************************************************         //10-29-97|0x0181
//*******************************************************************************         //10-29-97|0x0181
// mail_dict_open                                                                         //10-01-03|0x0181
//*******************************************************************************         //10-29-97|0x0181
//*******************************************************************************         //10-29-97|0x0181
UINT MAILDICT::mail_dict_open(                                                            //10-01-03|0x0181
    UINT Index                                                                            //10-01-03|0x0181
    ) {                                                                                   //10-01-03|0x0181
//*******************************************************************************         //10-29-97|0x0181
//***************************************************************************             //10-01-03|0x0185
//***************************************************************************             //10-01-03|0x0186
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x0187
    if(MailState      != MAIL_BOX_FILE_READY)               ReturnSystemError             //10-01-03|0x0188
    MailState         =  MAIL_BOX_FILE_OPENED;                                            //10-01-03|0x0189
//***************************************************************************             //10-01-03|0x018a
    switch(mail_dict_control_read(Index))                        _SwitchGroup             //10-01-03|0x018b
//***************************************************************************             //10-01-03|0x018c
    return_test(mail_dict_open_1);                                                        //10-01-03|0x018d
}                                                                                         //10-01-03|0x018e
//                                                                                        //05-24-97|0x018e
//***************************************************************************             //10-01-03|0x0191
//***************************************************************************             //10-01-03|0x0192
//******                                                               ******             //10-01-03|0x0193
//******               mail_dict_close(Index)                          ******             //10-01-03|0x0194
//******                                                               ******             //10-01-03|0x0195
//***************************************************************************             //10-01-03|0x0196
//***************************************************************************             //10-01-03|0x0197
//*******************************************************************************         //10-29-97|0x019c
//*******************************************************************************         //10-29-97|0x019c
// mail_dict_close                                                                        //10-01-03|0x019c
//*******************************************************************************         //10-29-97|0x019c
//*******************************************************************************         //10-29-97|0x019c
UINT MAILDICT::mail_dict_close(                                                           //10-01-03|0x019c
    UINT Index                                                                            //10-01-03|0x019c
    ) {                                                                                   //10-01-03|0x019c
//*******************************************************************************         //10-29-97|0x019c
//***************************************************************************             //10-01-03|0x01a0
//***************************************************************************             //10-01-03|0x01a1
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x01a2
    if(MailState      != MAIL_BOX_FILE_OPENED)              ReturnSystemError             //10-01-03|0x01a3
    MailState         =  MAIL_BOX_FILE_READY;                                             //10-01-03|0x01a4
//***************************************************************************             //10-01-03|0x01a5
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x01a6
    switch(mail_dict_control_write(Index))                       _SwitchGroup             //10-01-03|0x01a7
//***************************************************************************             //10-01-03|0x01a8
    return_test(mail_dict_close_1);                                                       //10-01-03|0x01a9
}                                                                                         //10-01-03|0x01aa
//                                                                                        //05-24-97|0x01aa
//***************************************************************************             //10-01-19|0x01ad
//***************************************************************************             //10-01-19|0x01ae
//******                                                               ******             //10-01-19|0x01af
//******               mail_dict_task_done()                           ******             //10-01-19|0x01b0
//******                                                               ******             //10-01-19|0x01b1
//***************************************************************************             //10-01-19|0x01b2
//***************************************************************************             //10-01-19|0x01b3
//*******************************************************************************         //10-29-97|0x01b8
//*******************************************************************************         //10-29-97|0x01b8
// mail_dict_task_done                                                                    //10-01-19|0x01b8
//*******************************************************************************         //10-29-97|0x01b8
//*******************************************************************************         //10-29-97|0x01b8
UINT MAILDICT::mail_dict_task_done(void) {                                                //10-01-19|0x01b8
//*******************************************************************************         //10-29-97|0x01b8
//***************************************************************************             //10-01-19|0x01bc
//***************************************************************************             //10-01-19|0x01bd
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-19|0x01be
    if((MailState     !=  MAIL_BOX_FILE_DATE) &&                                          //10-04-30|0x01bf
       (MailState     !=  MAIL_BOX_FILE_READY))                                           //10-04-30|0x01c0
                                                            ReturnSystemError             //10-01-19|0x01c1
    MailState         =  MAIL_BOX_FILE_DATE;                                              //10-01-19|0x01c2
//***************************************************************************             //10-01-19|0x01c3
    MailIndex         =  -1;                                                              //10-01-19|0x01c4
//***************************************************************************             //10-01-19|0x01c5
    return_test(mail_dict_task_done_1);                                                   //10-01-19|0x01c6
}                                                                                         //10-01-19|0x01c7
//                                                                                        //05-24-97|0x01c7
//***************************************************************************             //10-01-19|0x01ca
//***************************************************************************             //10-01-19|0x01cb
//******                                                               ******             //10-01-19|0x01cc
//******               mail_dict_finish_project()                      ******             //10-01-19|0x01cd
//******                                                               ******             //10-01-19|0x01ce
//***************************************************************************             //10-01-19|0x01cf
//***************************************************************************             //10-01-19|0x01d0
//*******************************************************************************         //10-29-97|0x01d6
//*******************************************************************************         //10-29-97|0x01d6
// mail_dict_finish_project                                                               //10-01-19|0x01d6
//*******************************************************************************         //10-29-97|0x01d6
//*******************************************************************************         //10-29-97|0x01d6
UINT MAILDICT::mail_dict_finish_project(void) {                                           //10-01-19|0x01d6
//*******************************************************************************         //10-29-97|0x01d6
//***************************************************************************             //10-01-19|0x01da
//***************************************************************************             //10-01-19|0x01db
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-19|0x01dc
    if((MailState     !=  MAIL_BOX_FILE_DATE) &&                                          //10-04-30|0x01dd
       (MailState     !=  ADD_MAIL_BOX_NAME))                                             //10-04-30|0x01de
                                                            ReturnSystemError             //10-04-30|0x01df
    MailState         =  MAIL_BOX_FILE_FINISHED;                                          //10-01-19|0x01e0
//***************************************************************************             //10-01-19|0x01e1
    return_test(mail_dict_finish_project_1);                                              //10-01-19|0x01e2
}                                                                                         //10-01-19|0x01e3
//                                                                                        //05-24-97|0x01e3
//***************************************************************************             //10-01-03|0x01e6
//***************************************************************************             //10-01-03|0x01e7
//******                                                               ******             //10-01-03|0x01e8
//******               mail_dict_complete(Index)                       ******             //10-01-03|0x01e9
//******                                                               ******             //10-01-03|0x01ea
//***************************************************************************             //10-01-03|0x01eb
//***************************************************************************             //10-01-03|0x01ec
//*******************************************************************************         //10-29-97|0x01f3
//*******************************************************************************         //10-29-97|0x01f3
// mail_dict_complete                                                                     //10-01-03|0x01f3
//*******************************************************************************         //10-29-97|0x01f3
//*******************************************************************************         //10-29-97|0x01f3
UINT MAILDICT::mail_dict_complete(                                                        //10-01-03|0x01f3
    UINT Index                                                                            //10-01-03|0x01f3
    ) {                                                                                   //10-01-03|0x01f3
//*******************************************************************************         //10-29-97|0x01f3
//***************************************************************************             //10-01-03|0x01f7
//***************************************************************************             //10-01-03|0x01f8
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x01f9
    if(MailState      !=  MAIL_BOX_FILE_FINISHED)           ReturnSystemError             //10-01-03|0x01fa
//***************************************************************************             //10-01-03|0x01fb
    switch(mail_dict_control_read(Index))                        _SwitchGroup             //10-01-03|0x01fc
//***************************************************************************             //10-01-03|0x01fd
    switch(BaseDictClose(MailDictAddr))                          _SwitchGroup             //10-01-03|0x01fe
//***************************************************************************             //10-01-03|0x01ff
    return_test(mail_dict_complete_1);                                                    //10-01-03|0x0200
}                                                                                         //10-01-03|0x0201
//                                                                                        //05-24-97|0x0201
//***************************************************************************             //10-01-03|0x0204
//***************************************************************************             //10-01-03|0x0205
//******                                                               ******             //10-01-03|0x0206
//******               mail_dict_publish(Index)                        ******             //10-01-03|0x0207
//******                                                               ******             //10-01-03|0x0208
//***************************************************************************             //10-01-03|0x0209
//***************************************************************************             //10-01-03|0x020a
//*******************************************************************************         //10-29-97|0x020f
//*******************************************************************************         //10-29-97|0x020f
// mail_dict_publish                                                                      //10-01-03|0x020f
//*******************************************************************************         //10-29-97|0x020f
//*******************************************************************************         //10-29-97|0x020f
UINT MAILDICT::mail_dict_publish(                                                         //10-01-03|0x020f
    UINT Index                                                                            //10-01-03|0x020f
    ) {                                                                                   //10-01-03|0x020f
//*******************************************************************************         //10-29-97|0x020f
//***************************************************************************             //10-01-03|0x0213
//***************************************************************************             //10-01-03|0x0214
  ULONG mailbox_time;                                                                //10-01-03|0x0215
//***************************************************************************             //10-01-03|0x0216
//***************************************************************************             //10-01-03|0x0217
    if(MailState      !=  MAIL_BOX_FILE_FINISHED)           ReturnSystemError             //10-01-03|0x0218
//***************************************************************************             //10-01-03|0x0219
    switch(mail_dict_control_read(Index))                        _SwitchGroup             //10-01-03|0x021a
//***************************************************************************             //10-01-03|0x021b
    switch(BaseDictClose(MailDictAddr))                          _SwitchGroup             //10-01-03|0x021c
//***************************************************************************             //10-01-03|0x021d
    MemSet(MailDictAddr,  0, sizeof(MailDict));                                           //10-01-03|0x021e
//***************************************************************************             //10-01-03|0x021f
    switch(BaseDictInitial(MailDictAddr, MailPathAddr, MBX_EXTENT))                       //10-01-03|0x0220
                                                                 _SwitchGroup             //10-01-03|0x0221
//***************************************************************************             //10-01-03|0x0222
    switch(BaseDictExists(MailDictAddr, &mailbox_time))          _SwitchGroup             //10-01-03|0x0223
    if(mailbox_time ==  0)                                  ReturnSystemError             //10-01-03|0x0224
//***************************************************************************             //10-01-03|0x0225
    switch(BaseDictAppendHash(MailDictAddr))                     _SwitchGroup             //10-01-03|0x0226
    switch(BaseDictComplete(MailDictAddr))                       _SwitchGroup             //10-01-03|0x0227
    switch(BaseDictClose(MailDictAddr))                          _SwitchGroup             //10-01-03|0x0228
//***************************************************************************             //10-01-03|0x0229
    return_test(mail_dict_publish_1);                                                     //10-01-03|0x022a
}                                                                                         //10-01-03|0x022b
//                                                                                        //05-24-97|0x022b
//***************************************************************************             //10-01-06|0x022e
//***************************************************************************             //10-01-06|0x022f
//******                                                               ******             //10-01-06|0x0230
//******               mail_dict_delete(Index)                         ******             //10-01-06|0x0231
//******                                                               ******             //10-01-06|0x0232
//***************************************************************************             //10-01-06|0x0233
//***************************************************************************             //10-01-06|0x0234
//*******************************************************************************         //10-29-97|0x0239
//*******************************************************************************         //10-29-97|0x0239
// mail_dict_delete                                                                       //10-01-06|0x0239
//*******************************************************************************         //10-29-97|0x0239
//*******************************************************************************         //10-29-97|0x0239
UINT MAILDICT::mail_dict_delete(                                                          //10-01-06|0x0239
    UINT Index                                                                            //10-01-06|0x0239
    ) {                                                                                   //10-01-06|0x0239
//*******************************************************************************         //10-29-97|0x0239
//***************************************************************************             //10-01-06|0x023d
//***************************************************************************             //10-01-06|0x023e
    if((MailState     !=  MAIL_BOX_FILE_FINISHED) &&                                      //10-01-06|0x023f
       (MailState     !=  MAIL_BOX_FILE_READY))             ReturnSystemError             //10-01-06|0x0240
//***************************************************************************             //10-01-06|0x0241
    switch(mail_dict_control_read(Index))                        _SwitchGroup             //10-01-06|0x0242
//***************************************************************************             //10-01-06|0x0243
    switch(BaseDictClose(MailDictAddr))                          _SwitchGroup             //10-01-06|0x0244
    switch(BaseDictDeleteDict(MailDictAddr))                     _SwitchGroup             //10-01-06|0x0245
//***************************************************************************             //10-01-06|0x0246
    return_test(mail_dict_delete_1);                                                      //10-01-06|0x0247
}                                                                                         //10-01-06|0x0248
//                                                                                        //05-24-97|0x0248
//***************************************************************************             //10-01-03|0x024b
//***************************************************************************             //10-01-03|0x024c
//******                                                               ******             //10-01-03|0x024d
//******               mail_dict_end()                                 ******             //10-01-03|0x024e
//******                                                               ******             //10-01-03|0x024f
//***************************************************************************             //10-01-03|0x0250
//***************************************************************************             //10-01-03|0x0251
//*******************************************************************************         //10-29-97|0x0255
//*******************************************************************************         //10-29-97|0x0255
// mail_dict_end                                                                          //10-01-03|0x0255
//*******************************************************************************         //10-29-97|0x0255
//*******************************************************************************         //10-29-97|0x0255
UINT MAILDICT::mail_dict_end(void) {                                                      //10-01-03|0x0255
//*******************************************************************************         //10-29-97|0x0255
//***************************************************************************             //10-01-03|0x0259
//***************************************************************************             //10-01-03|0x025a
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x025b
//***************************************************************************             //10-01-03|0x025c
    MailState         =  START_STATE;                                                     //10-01-03|0x025d
//***************************************************************************             //10-01-03|0x025e
    switch(FileCommitBinary(MailFileAddr))                       _SwitchGroup             //10-01-03|0x025f
    switch(FileClose())                                          _SwitchGroup             //10-01-03|0x0260
    switch(FileDelete())                                         _SwitchGroup             //10-01-03|0x0261
    switch(FileRelease())                                        _SwitchGroup             //10-01-03|0x0262
//***************************************************************************             //10-01-03|0x0263
    return_test(mail_dict_end_1);                                                         //10-01-03|0x0264
}                                                                                         //10-01-03|0x0265
//                                                                                        //05-24-97|0x0265
//***************************************************************************             //09-03-11|0x0268
//***************************************************************************             //09-03-11|0x0269
//******                                                               ******             //09-03-11|0x026a
//******              mail_dict_add_zip(Index, InputTokens)            ******             //10-01-03|0x026b
//******                                                               ******             //09-03-11|0x026c
//***************************************************************************             //09-03-11|0x026d
//***************************************************************************             //09-03-11|0x026e
//*******************************************************************************         //10-29-97|0x0274
//*******************************************************************************         //10-29-97|0x0274
// maildict_add_zip                                                                       //10-01-03|0x0274
//*******************************************************************************         //10-29-97|0x0274
//*******************************************************************************         //10-29-97|0x0274
UINT MAILDICT::maildict_add_zip(                                                          //10-01-03|0x0274
    SINT Index,                                                                           //10-01-03|0x0274
    TOKENS_FAR Token                                                                      //10-01-03|0x0274
    ) {                                                                                   //10-01-03|0x0274
//*******************************************************************************         //10-29-97|0x0274
//***************************************************************************             //09-03-11|0x0278
//***************************************************************************             //09-03-11|0x0279
//***************************************************************************             //10-01-03|0x027a
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x027b
//***************************************************************************             //09-03-11|0x027c
    if(TokenNoTokens   < 2)                                 ReturnSystemError             //09-03-11|0x027d
    if(TokenNoTokens   > 2)                                 ReturnSystemError             //09-03-11|0x027e
//***************************************************************************             //09-03-11|0x027f
//***************************************************************************             //09-03-11|0x0280
    switch(BaseDictBeginEntry(MailDictAddr,   TokenTokenAddr(1),                          //09-03-11|0x0281
                              SD_ENTRY_NAME,  TokenType(1)))                              //09-03-11|0x0282
      {                                                                                   //09-03-11|0x0283
        case Success:                         break_test(maildict_add_zip_1);             //09-03-11|0x0284
        case UserError:       ReturnFinish("Post Office Previously Defined");             //09-03-11|0x0285
        default:                                            ReturnSystemError             //09-03-11|0x0286
        }                                                                                 //09-03-11|0x0287
//***************************************************************************             //09-03-11|0x0288
    switch(BaseDictEndEntry(MailDictAddr))                       _SwitchGroup             //09-03-11|0x0289
    return_test(maildict_add_zip_2);                                                      //09-06-13|0x028a
}                                                                                         //09-03-11|0x028b
//                                                                                        //05-24-97|0x028b
//***************************************************************************             //09-03-11|0x028e
//***************************************************************************             //09-03-11|0x028f
//******                                                               ******             //09-03-11|0x0290
//******               mail_dict_add_po_box(Index, InputToken)         ******             //10-01-03|0x0291
//******                                                               ******             //09-03-11|0x0292
//***************************************************************************             //09-03-11|0x0293
//***************************************************************************             //09-03-11|0x0294
//*******************************************************************************         //10-29-97|0x029c
//*******************************************************************************         //10-29-97|0x029c
// mail_dict_add_po_box                                                                   //check   |0x029c
//*******************************************************************************         //10-29-97|0x029c
//*******************************************************************************         //10-29-97|0x029c
UINT MAILDICT::mail_dict_add_po_box(                                                      //check   |0x029c
    TOKENS_FAR Token                                                                      //check   |0x029c
    ) {                                                                                   //check   |0x029c
//*******************************************************************************         //10-29-97|0x029c
//***************************************************************************             //09-03-11|0x02a0
//***************************************************************************             //09-03-11|0x02a1
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x02a2
    if(MailState      !=  MAIL_BOX_FILE_OPENED)             ReturnSystemError             //10-01-03|0x02a3
//***************************************************************************             //09-03-11|0x02a4
    if(TokenNoTokens   < 3)                                 ReturnSystemError             //09-03-11|0x02a5
    if(TokenNoTokens   > 3)                                 ReturnSystemError             //09-03-11|0x02a6
//***************************************************************************             //09-03-11|0x02a7
    switch(mail_zip_find(TokenTokenAddr(1)))                                              //09-03-11|0x02a8
      {                                                                                   //09-03-11|0x02a9
        case Yes:                         break_test(mail_dict_add_po_box_1);             //09-03-11|0x02aa
        case No:                     ReturnFinish("Post Office Not Defined");             //09-03-11|0x02ab
        case UserError:                                    return(UserError);             //09-03-11|0x02ac
        default:                                            ReturnSystemError             //09-03-11|0x02ad
        }                                                                                 //09-03-11|0x02ae
//***************************************************************************             //09-03-11|0x02af
    switch(mail_po_box_find(TokenTokenAddr(2)))                                           //09-03-11|0x02b0
      {                                                                                   //09-03-11|0x02b1
        case No:                          break_test(mail_dict_add_po_box_3);             //09-03-11|0x02b2
        case Yes:                                                                         //09-03-11|0x02b3
          switch(BaseDictEndEntry(MailDictAddr))                 _SwitchGroup             //09-03-11|0x02b4
          ReturnFinish("Post Office Box Previously Defined");                             //09-03-11|0x02b5
        case UserError:                                    return(UserError);             //09-03-11|0x02b6
        default:                                            ReturnSystemError             //09-03-11|0x02b7
        }                                                                                 //09-03-11|0x02b8
//***************************************************************************             //09-03-11|0x02b9
    switch(BaseDictAddNext(MailDictAddr,  TokenTokenAddr(2),                              //09-03-11|0x02ba
                           SD_ENTRY_NAME, TokenType(2)))                                  //09-03-11|0x02bb
      {                                                                                   //09-03-11|0x02bc
        case Success:                     break_test(mail_dict_add_po_box_4);             //09-03-11|0x02bd
        default:                                            ReturnSystemError             //09-03-11|0x02be
        }                                                                                 //09-03-11|0x02bf
//***************************************************************************             //09-03-11|0x02c0
    switch(BaseDictEndEntry(MailDictAddr))                       _SwitchGroup             //09-03-11|0x02c1
    return_test(mail_dict_add_po_box_5);                                                  //09-03-11|0x02c2
}                                                                                         //09-03-11|0x02c3
//                                                                                        //05-24-97|0x02c3
//***************************************************************************             //09-03-13|0x02c6
//***************************************************************************             //09-03-13|0x02c7
//******                                                               ******             //09-03-13|0x02c8
//******               mail_dict_load_po_box(Index, InputToken)        ******             //10-01-03|0x02c9
//******                                                               ******             //09-03-13|0x02ca
//***************************************************************************             //09-03-13|0x02cb
//***************************************************************************             //09-03-13|0x02cc
//*******************************************************************************         //10-29-97|0x02d5
//*******************************************************************************         //10-29-97|0x02d5
// mail_dict_load_po_box                                                                  //10-01-03|0x02d5
//*******************************************************************************         //10-29-97|0x02d5
//*******************************************************************************         //10-29-97|0x02d5
UINT MAILDICT::mail_dict_load_po_box(                                                     //10-01-03|0x02d5
    SINT Index,                                                                           //10-01-03|0x02d5
    TOKENS_FAR Token                                                                      //10-01-03|0x02d5
    ) {                                                                                   //10-01-03|0x02d5
//*******************************************************************************         //10-29-97|0x02d5
//***************************************************************************             //09-03-13|0x02d9
//***************************************************************************             //09-03-13|0x02da
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x02db
    if(MailState      !=  MAIL_BOX_FILE_OPENED)             ReturnSystemError             //10-01-03|0x02dc
//***************************************************************************             //10-01-03|0x02dd
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x02de
//***************************************************************************             //09-03-13|0x02df
    if(TokenNoTokens   < 4)                                 ReturnSystemError             //09-03-13|0x02e0
    if(TokenNoTokens   > 4)                                 ReturnSystemError             //09-03-13|0x02e1
//***************************************************************************             //09-03-14|0x02e2
    switch(mail_zip_find(TokenTokenAddr(1)))                                              //09-03-16|0x02e3
      {                                                                                   //09-03-16|0x02e4
        case Yes:                        break_test(mail_dict_load_po_box_1);             //09-03-16|0x02e5
        case No:                     ReturnFinish("Post Office Not Defined");             //09-03-16|0x02e6
        case UserError:                                    return(UserError);             //09-03-16|0x02e7
        default:                                            ReturnSystemError             //09-03-16|0x02e8
        }                                                                                 //09-03-16|0x02e9
//***************************************************************************             //09-03-16|0x02ea
    switch(mail_po_box_find(TokenTokenAddr(2)))                                           //09-03-16|0x02eb
      {                                                                                   //09-03-16|0x02ec
        case Yes:                        break_test(mail_dict_load_po_box_2);             //09-03-16|0x02ed
        case No:                 ReturnFinish("Post Office Box Not Defined");             //09-03-16|0x02ee
        case UserError:                                    return(UserError);             //09-03-16|0x02ef
        default:                                            ReturnSystemError             //09-03-16|0x02f0
        }                                                                                 //09-03-16|0x02f1
//***************************************************************************             //09-09-17|0x02f2
    switch(BaseDictTestArg(MailDictAddr, 1))                                              //09-09-17|0x02f3
      {                                                                                   //09-09-17|0x02f4
        case Yes:                  ReturnFinish("Post Office Box Not Empty");             //09-09-17|0x02f5
        case No:                         break_test(mail_dict_load_po_box_3);             //09-09-17|0x02f6
        case UserError:                                    return(UserError);             //09-09-17|0x02f7
        default:                                            ReturnSystemError             //09-09-17|0x02f8
        }                                                                                 //09-09-17|0x02f9
//***************************************************************************             //09-03-16|0x02fa
    switch(BaseDictArgUpdate(MailDictAddr))                      _SwitchGroup             //09-03-17|0x02fb
//***************************************************************************             //09-03-16|0x02fc
    switch(BaseDictAddArg(MailDictAddr, TokenTokenAddr(3), TokenType(3)))                 //09-03-16|0x02fd
      {                                                                                   //09-03-16|0x02fe
        case Success:                     break_test(mail_dict_load_po_box_4)             //09-03-16|0x02ff
        default:                                            ReturnSystemError             //09-03-16|0x0300
        }                                                                                 //09-03-16|0x0301
//***************************************************************************             //09-03-16|0x0302
    switch(BaseDictEndEntry(MailDictAddr))                       _SwitchGroup             //09-03-16|0x0303
    return_test(mail_dict_load_po_box_5);                                                 //09-03-16|0x0304
}                                                                                         //09-03-16|0x0305
//                                                                                        //05-24-97|0x0305
//***************************************************************************             //09-09-17|0x0308
//***************************************************************************             //09-09-17|0x0309
//******                                                               ******             //09-09-17|0x030a
//******               mail_dict_empty_po_box(Index, InputToken)       ******             //10-01-03|0x030b
//******                                                               ******             //09-09-17|0x030c
//***************************************************************************             //09-09-17|0x030d
//***************************************************************************             //09-09-17|0x030e
//*******************************************************************************         //10-29-97|0x0315
//*******************************************************************************         //10-29-97|0x0315
// mail_dict_empty_po_box                                                                 //10-01-03|0x0315
//*******************************************************************************         //10-29-97|0x0315
//*******************************************************************************         //10-29-97|0x0315
UINT MAILDICT::mail_dict_empty_po_box(                                                    //10-01-03|0x0315
    SINT Index,                                                                           //10-01-03|0x0315
    TOKENS_FAR Token                                                                      //10-01-03|0x0315
    ) {                                                                                   //10-01-03|0x0315
//*******************************************************************************         //10-29-97|0x0315
//***************************************************************************             //09-09-17|0x0319
//***************************************************************************             //09-09-17|0x031a
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x031b
    if(MailState      !=  MAIL_BOX_FILE_OPENED)             ReturnSystemError             //10-01-03|0x031c
//***************************************************************************             //10-01-03|0x031d
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x031e
//***************************************************************************             //09-09-17|0x031f
    if(TokenNoTokens   < 3)                                 ReturnSystemError             //09-09-17|0x0320
    if(TokenNoTokens   > 3)                                 ReturnSystemError             //09-09-17|0x0321
//***************************************************************************             //09-09-17|0x0322
    switch(mail_zip_find(TokenTokenAddr(1)))                                              //09-09-17|0x0323
      {                                                                                   //09-09-17|0x0324
        case Yes:                       break_test(mail_dict_empty_po_box_1);             //09-09-17|0x0325
        case No:                     ReturnFinish("Post Office Not Defined");             //09-09-17|0x0326
        case UserError:                                    return(UserError);             //09-09-17|0x0327
        default:                                            ReturnSystemError             //09-09-17|0x0328
        }                                                                                 //09-09-17|0x0329
//***************************************************************************             //09-09-17|0x032a
    switch(mail_po_box_find(TokenTokenAddr(2)))                                           //09-09-17|0x032b
      {                                                                                   //09-09-17|0x032c
        case Yes:                       break_test(mail_dict_empty_po_box_2);             //09-09-17|0x032d
        case No:                 ReturnFinish("Post Office Box Not Defined");             //09-09-17|0x032e
        case UserError:                                    return(UserError);             //09-09-17|0x032f
        default:                                            ReturnSystemError             //09-09-17|0x0330
        }                                                                                 //09-09-17|0x0331
//***************************************************************************             //09-09-17|0x0332
    switch(BaseDictArgUpdate(MailDictAddr))                      _SwitchGroup             //09-09-17|0x0333
//***************************************************************************             //09-09-17|0x0334
    switch(BaseDictEndEntry(MailDictAddr))                       _SwitchGroup             //09-09-17|0x0335
    return_test(mail_dict_empty_po_box_3);                                                //09-09-17|0x0336
}                                                                                         //09-09-17|0x0337
//                                                                                        //05-24-97|0x0337
//***************************************************************************             //09-03-14|0x033a
//***************************************************************************             //09-03-14|0x033b
//******                                                               ******             //09-03-14|0x033c
//******             mail_dict_get_mail(Index, Result,Token)           ******             //10-01-03|0x033d
//******                                                               ******             //09-03-14|0x033e
//***************************************************************************             //09-03-14|0x033f
//***************************************************************************             //09-03-14|0x0340
//*******************************************************************************         //10-29-97|0x0347
//*******************************************************************************         //10-29-97|0x0347
// mail_dict_get_mail                                                                     //10-01-03|0x0347
//*******************************************************************************         //10-29-97|0x0347
//*******************************************************************************         //10-29-97|0x0347
UINT MAILDICT::mail_dict_get_mail(                                                        //10-01-03|0x0347
    SINT Index,                                                                           //10-01-03|0x0347
    STRING_DATA_FAR Results,                                                              //10-01-03|0x0347
    TOKENS_FAR Token                                                                      //10-01-03|0x0347
    ) {                                                                                   //10-01-03|0x0347
//*******************************************************************************         //10-29-97|0x0347
//***************************************************************************             //09-03-14|0x034b
//***************************************************************************             //09-03-14|0x034c
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x034d
    if(MailState      !=  MAIL_BOX_FILE_OPENED)             ReturnSystemError             //10-01-03|0x034e
//***************************************************************************             //10-01-03|0x034f
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x0350
//***************************************************************************             //09-03-14|0x0351
    if(TokenNoTokens   < 4)                                 ReturnSystemError             //09-03-14|0x0352
    if(TokenNoTokens   > 4)                                 ReturnSystemError             //09-03-14|0x0353
//***************************************************************************             //09-03-14|0x0354
//***************************************************************************             //09-03-17|0x0355
    switch(mail_zip_find(TokenTokenAddr(2)))                                              //09-03-17|0x0356
      {                                                                                   //09-03-17|0x0357
        case Yes:                           break_test(mail_dict_get_mail_1);             //09-03-17|0x0358
        case No:                     ReturnFinish("Post Office Not Defined");             //09-03-17|0x0359
        case UserError:                                    return(UserError);             //09-03-17|0x035a
        default:                                            ReturnSystemError             //09-03-17|0x035b
        }                                                                                 //09-03-17|0x035c
//***************************************************************************             //09-03-17|0x035d
    switch(mail_po_box_find(TokenTokenAddr(3)))                                           //09-03-17|0x035e
      {                                                                                   //09-03-17|0x035f
        case Yes:                           break_test(mail_dict_get_mail_3);             //09-03-17|0x0360
        case No:                 ReturnFinish("Post Office Box Not Defined");             //09-03-17|0x0361
        case UserError:                                    return(UserError);             //09-03-17|0x0362
        default:                                            ReturnSystemError             //09-03-17|0x0363
        }                                                                                 //09-03-17|0x0364
//***************************************************************************             //09-03-17|0x0365
    switch(BaseDictGetArg(MailDictAddr, Results, 1))                                      //09-03-17|0x0366
      {                                                                                   //09-03-17|0x0367
        case Success:                       break_test(mail_dict_get_mail_4);             //09-03-17|0x0368
        case UserError:          ReturnFinish("Post Office Box Empty");                   //09-03-17|0x0369
        default:                                            ReturnSystemError             //09-03-17|0x036a
        }                                                                                 //09-03-17|0x036b
//***************************************************************************             //09-03-17|0x036c
    switch(BaseDictEndEntry(MailDictAddr))                       _SwitchGroup             //09-03-17|0x036d
    return_test(mail_dict_get_mail_4);                                                    //09-03-17|0x036e
}                                                                                         //09-03-17|0x036f
//                                                                                        //05-24-97|0x036f
//***************************************************************************             //09-03-17|0x0372
//***************************************************************************             //09-03-17|0x0373
//******                                                               ******             //09-03-17|0x0374
//******               mail_dict_zip_exists(Index,  Name)              ******             //10-01-03|0x0375
//******                                                               ******             //09-03-17|0x0376
//***************************************************************************             //09-03-17|0x0377
//***************************************************************************             //09-03-17|0x0378
//*******************************************************************************         //10-29-97|0x037f
//*******************************************************************************         //10-29-97|0x037f
// mail_dict_zip_exists                                                                   //10-01-03|0x037f
//*******************************************************************************         //10-29-97|0x037f
//*******************************************************************************         //10-29-97|0x037f
UINT MAILDICT::mail_dict_zip_exists(                                                      //10-01-03|0x037f
    SINT Index,                                                                           //10-01-03|0x037f
    STRING_DATA_FAR Name                                                                  //10-01-03|0x037f
    ) {                                                                                   //10-01-03|0x037f
//*******************************************************************************         //10-29-97|0x037f
//***************************************************************************             //09-03-17|0x0383
//***************************************************************************             //09-03-17|0x0384
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x0385
    if(MailState      !=  MAIL_BOX_FILE_OPENED)             ReturnSystemError             //10-01-03|0x0386
//***************************************************************************             //10-01-03|0x0387
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x0388
//***************************************************************************             //09-03-17|0x0389
    switch(mail_zip_find(Name))                                                           //09-03-17|0x038a
      {                                                                                   //09-03-17|0x038b
        case Yes:                         break_test(mail_dict_zip_exists_1);             //09-03-17|0x038c
        case No:                           return_no(mail_dict_zip_exists_2);             //09-03-17|0x038d
        case UserError:                                    return(UserError);             //09-03-17|0x038e
        default:                                            ReturnSystemError             //09-03-17|0x038f
        }                                                                                 //09-03-17|0x0390
//***************************************************************************             //09-03-17|0x0391
    switch(BaseDictEndEntry(MailDictAddr))                       _SwitchGroup             //09-03-17|0x0392
    return_yes(mail_dict_zip_exists_3);                                                   //09-03-17|0x0393
}                                                                                         //09-03-17|0x0394
//                                                                                        //05-24-97|0x0394
//***************************************************************************             //09-03-17|0x0397
//***************************************************************************             //09-03-17|0x0398
//******                                                               ******             //09-03-17|0x0399
//******               mail_dict_po_box_exists(Index, Token)           ******             //10-01-03|0x039a
//******                                                               ******             //09-03-17|0x039b
//***************************************************************************             //09-03-17|0x039c
//***************************************************************************             //09-03-17|0x039d
//*******************************************************************************         //10-29-97|0x03a4
//*******************************************************************************         //10-29-97|0x03a4
// mail_dict_po_box_exists                                                                //10-01-03|0x03a4
//*******************************************************************************         //10-29-97|0x03a4
//*******************************************************************************         //10-29-97|0x03a4
UINT MAILDICT::mail_dict_po_box_exists(                                                   //10-01-03|0x03a4
    SINT Index,                                                                           //10-01-03|0x03a4
    TOKENS_FAR Token                                                                      //10-01-03|0x03a4
    ) {                                                                                   //10-01-03|0x03a4
//*******************************************************************************         //10-29-97|0x03a4
//***************************************************************************             //09-03-17|0x03a8
//***************************************************************************             //09-03-17|0x03a9
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x03aa
    if(MailState      !=  MAIL_BOX_FILE_OPENED)             ReturnSystemError             //10-01-03|0x03ab
//***************************************************************************             //10-01-03|0x03ac
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x03ad
//***************************************************************************             //09-09-17|0x03ae
    if(TokenNoTokens   < 3)                                 ReturnSystemError             //10-01-03|0x03af
    if(TokenNoTokens   > 3)                                 ReturnSystemError             //10-01-03|0x03b0
//***************************************************************************             //09-03-17|0x03b1
    switch(mail_zip_find(TokenTokenAddr(1)))                                              //09-03-17|0x03b2
      {                                                                                   //09-03-17|0x03b3
        case Yes:                      break_test(mail_dict_po_box_exists_1);             //09-03-17|0x03b4
        case No:                     ReturnFinish("Post Office Not Defined");             //09-03-17|0x03b5
        case UserError:                                    return(UserError);             //09-03-17|0x03b6
        default:                                            ReturnSystemError             //09-03-17|0x03b7
        }                                                                                 //09-03-17|0x03b8
//***************************************************************************             //09-03-17|0x03b9
    switch(mail_po_box_find(TokenTokenAddr(2)))                                           //09-03-17|0x03ba
      {                                                                                   //09-03-17|0x03bb
        case Yes:                                                                         //09-03-17|0x03bc
          switch(BaseDictEndEntry(MailDictAddr))                 _SwitchGroup             //09-03-17|0x03bd
          return_yes(mail_dict_po_box_exists_2);                                          //09-03-17|0x03be
        case No:                                                                          //09-03-17|0x03bf
          switch(BaseDictEndEntry(MailDictAddr))                 _SwitchGroup             //09-03-17|0x03c0
          return_no(mail_dict_po_box_exists_3);                                           //09-03-17|0x03c1
        case UserError:                                    return(UserError);             //09-03-17|0x03c2
        default:                                            ReturnSystemError             //09-03-17|0x03c3
        }                                                                                 //09-03-17|0x03c4
}                                                                                         //09-03-17|0x03c5
//                                                                                        //05-24-97|0x03c5
//***************************************************************************             //09-03-17|0x03c8
//***************************************************************************             //09-03-17|0x03c9
//******                                                               ******             //09-03-17|0x03ca
//******               mail_dict_test_mail(Index, Token)               ******             //10-01-03|0x03cb
//******                                                               ******             //09-03-17|0x03cc
//***************************************************************************             //09-03-17|0x03cd
//***************************************************************************             //09-03-17|0x03ce
//*******************************************************************************         //10-29-97|0x03d6
//*******************************************************************************         //10-29-97|0x03d6
// mail_dict_test_mail                                                                    //10-01-03|0x03d6
//*******************************************************************************         //10-29-97|0x03d6
//*******************************************************************************         //10-29-97|0x03d6
UINT MAILDICT::mail_dict_test_mail(                                                       //10-01-03|0x03d6
    SINT Index,                                                                           //10-01-03|0x03d6
    TOKENS_FAR Token                                                                      //10-01-03|0x03d6
    ) {                                                                                   //10-01-03|0x03d6
//*******************************************************************************         //10-29-97|0x03d6
//***************************************************************************             //09-03-17|0x03da
//***************************************************************************             //09-03-17|0x03db
    if(mail_dict_addr == 0)                                 ReturnSystemError             //10-01-03|0x03dc
    if(MailState      !=  MAIL_BOX_FILE_OPENED)             ReturnSystemError             //10-01-03|0x03dd
//***************************************************************************             //10-01-03|0x03de
    switch(mail_dict_control_verify(Index))                      _SwitchGroup             //10-01-03|0x03df
//***************************************************************************             //09-09-17|0x03e0
    if(TokenNoTokens   < 3)                                 ReturnSystemError             //10-01-03|0x03e1
    if(TokenNoTokens   > 3)                                 ReturnSystemError             //10-01-03|0x03e2
//***************************************************************************             //09-03-17|0x03e3
    switch(mail_zip_find(TokenTokenAddr(1)))                                              //09-03-17|0x03e4
      {                                                                                   //09-03-17|0x03e5
        case Yes:                          break_test(mail_dict_test_mail_1);             //09-03-17|0x03e6
        case No:                     ReturnFinish("Post Office Not Defined");             //09-03-17|0x03e7
        case UserError:                                    return(UserError);             //09-03-17|0x03e8
        default:                                            ReturnSystemError             //09-03-17|0x03e9
        }                                                                                 //09-03-17|0x03ea
//***************************************************************************             //09-03-17|0x03eb
    switch(mail_po_box_find(TokenTokenAddr(2)))                                           //09-03-17|0x03ec
      {                                                                                   //09-03-17|0x03ed
        case Yes:                          break_test(mail_dict_test_mail_2);             //09-03-17|0x03ee
        case No:                 ReturnFinish("Post Office Box Not Defined");             //09-03-17|0x03ef
        case UserError:                                    return(UserError);             //09-03-17|0x03f0
        default:                                            ReturnSystemError             //09-03-17|0x03f1
        }                                                                                 //09-03-17|0x03f2
//***************************************************************************             //09-03-17|0x03f3
    switch(BaseDictTestArg(MailDictAddr, 1))                                              //09-03-17|0x03f4
      {                                                                                   //09-03-17|0x03f5
        case Yes: switch(BaseDictEndEntry(MailDictAddr))         _SwitchGroup             //09-03-17|0x03f6
                  return_yes(mail_dict_test_mail_3);                                      //09-03-17|0x03f7
        case No:  switch(BaseDictEndEntry(MailDictAddr))         _SwitchGroup             //09-03-17|0x03f8
                  return_no(mail_dict_test_mail_4);                                       //09-03-17|0x03f9
        case UserError:                                    return(UserError);             //09-03-17|0x03fa
        default:                                            ReturnSystemError             //09-03-17|0x03fb
        }                                                                                 //09-03-17|0x03fc
}                                                                                         //09-03-17|0x03fd
//                                                                                        //05-24-97|0x03fd
//***************************************************************************             //09-03-16|0x0400
//***************************************************************************             //09-03-16|0x0401
//******                                                               ******             //09-03-16|0x0402
//******               mail_dict_find(InputString)                     ******             //09-03-16|0x0403
//******                                                               ******             //09-03-16|0x0404
//***************************************************************************             //09-03-16|0x0405
//***************************************************************************             //09-03-16|0x0406
//*******************************************************************************         //10-29-97|0x040c
//*******************************************************************************         //10-29-97|0x040c
// mail_zip_find                                                                          //09-03-16|0x040c
//*******************************************************************************         //10-29-97|0x040c
//*******************************************************************************         //10-29-97|0x040c
UINT MAILDICT::mail_zip_find(                                                             //09-03-16|0x040c
    STRING_DATA_FAR Addr                                                                  //09-03-16|0x040c
    ) {                                                                                   //09-03-16|0x040c
//*******************************************************************************         //10-29-97|0x040c
//***************************************************************************             //09-03-16|0x040f
//***************************************************************************             //09-03-16|0x0410
  UINT command;                                                                      //09-03-16|0x0411
//***************************************************************************             //09-03-16|0x0412
//***************************************************************************             //09-03-16|0x0413
    switch(BaseDictSearch(MailDictAddr, Addr,  AddrType))                                 //09-03-16|0x0414
      {                                                                                   //09-03-16|0x0415
        case Yes:                                                      break;             //09-03-16|0x0416
        case No:                                  return_no(mail_zip_find_1);             //09-03-16|0x0417
        default:                                            ReturnSystemError             //09-03-16|0x0418
        }                                                                                 //09-03-16|0x0419
//***************************************************************************             //09-03-16|0x041a
    switch(BaseDictGetFirstCmd(MailDictAddr, &command))                                   //09-03-16|0x041b
      {                                                                                   //09-03-16|0x041c
        case Success:                                                  break;             //09-03-16|0x041d
        case UserError:                                           return(No);             //09-03-16|0x041e
        default:                                            ReturnSystemError             //09-03-16|0x041f
        }                                                                                 //09-03-16|0x0420
//---------------------------------------------------------------------------             //09-03-16|0x0421
    switch(command)                                                                       //09-03-16|0x0422
      {                                                                                   //09-03-16|0x0423
        case SD_ENTRY_NAME:                      return_yes(mail_zip_find_2);             //09-03-16|0x0424
        default:                                           return(UserError);             //09-03-16|0x0425
        }                                                                                 //09-03-16|0x0426
}                                                                                         //09-03-16|0x0427
//                                                                                        //05-24-97|0x0427
//***************************************************************************             //09-03-16|0x042a
//***************************************************************************             //09-03-16|0x042b
//******                                                               ******             //09-03-16|0x042c
//******                   mail_sub_find(Addr)                         ******             //09-03-16|0x042d
//******                                                               ******             //09-03-16|0x042e
//***************************************************************************             //09-03-16|0x042f
//***************************************************************************             //09-03-16|0x0430
//*******************************************************************************         //10-29-97|0x0436
//*******************************************************************************         //10-29-97|0x0436
// mail_po_box_find                                                                       //09-03-16|0x0436
//*******************************************************************************         //10-29-97|0x0436
//*******************************************************************************         //10-29-97|0x0436
UINT MAILDICT::mail_po_box_find(                                                          //09-03-16|0x0436
    STRING_DATA_FAR Addr                                                                  //09-03-16|0x0436
    ) {                                                                                   //09-03-16|0x0436
//*******************************************************************************         //10-29-97|0x0436
//***************************************************************************             //09-03-16|0x0439
//***************************************************************************             //09-03-16|0x043a
  STRING_DATA work;                                                                  //09-03-16|0x043b
//***************************************************************************             //09-03-16|0x043c
//***************************************************************************             //09-03-16|0x043d
loop:                                                                                     //09-03-16|0x043e
    switch(mail_get_next())                                                               //09-03-16|0x043f
      {                                                                                   //09-03-16|0x0440
//---------------------------------------------------------------------------             //09-03-16|0x0441
        case Yes:                                                                         //09-03-16|0x0442
          switch(BaseDictGetArg(MailDictAddr, &work, 0))                                  //09-03-16|0x0443
            {                                                                             //09-03-16|0x0444
              case Success:                                                               //09-03-16|0x0445
                if(WorkLength > 256)                        ReturnSystemError             //09-03-16|0x0446
                if(AddrLength > 256)                        ReturnSystemError             //09-03-16|0x0447
                if(WorkChar(WorkLength))                    ReturnSystemError             //09-03-16|0x0448
                if(AddrChar(AddrLength))                    ReturnSystemError             //09-03-16|0x0449
                if(WorkLength != AddrLength)                       goto loop;             //09-03-16|0x044a
                switch(StrCmp(AddrLineAddr, WorkLineAddr))                                //11-05-30|0x044b
                  {                                                                       //11-05-30|0x044c
                    case 0:                   return_yes(mail_po_box_find_1);             //11-05-30|0x044d
                    case 1:                                                               //11-05-30|0x044e
                    case -1:                                       goto loop;             //11-05-30|0x044f
                    default:                                ReturnSystemError             //11-05-30|0x0450
                    }                                                                     //11-05-30|0x0451
              default:                                      ReturnSystemError             //09-03-16|0x0452
              }                                                                           //09-03-16|0x0453
//---------------------------------------------------------------------------             //09-03-16|0x0454
        case No:                                return_no(mail_po_box_find_2)             //09-03-16|0x0455
        default:                                            ReturnSystemError             //09-03-16|0x0456
        }                                                                                 //09-03-16|0x0457
}                                                                                         //09-03-16|0x0458
//                                                                                        //05-24-97|0x0458
//***************************************************************************             //09-03-16|0x045b
//***************************************************************************             //09-03-16|0x045c
//******                                                               ******             //09-03-16|0x045d
//******               mail_get_next()                                 ******             //09-03-16|0x045e
//******                                                               ******             //09-03-16|0x045f
//***************************************************************************             //09-03-16|0x0460
//***************************************************************************             //09-03-16|0x0461
//*******************************************************************************         //10-29-97|0x0466
//*******************************************************************************         //10-29-97|0x0466
// mail_get_next                                                                          //09-03-16|0x0466
//*******************************************************************************         //10-29-97|0x0466
//*******************************************************************************         //10-29-97|0x0466
UINT MAILDICT::mail_get_next(void) {                                                      //09-03-16|0x0466
//*******************************************************************************         //10-29-97|0x0466
//***************************************************************************             //09-03-16|0x0467
//***************************************************************************             //09-03-16|0x0468
  UINT command;                                                                      //09-03-16|0x0469
//***************************************************************************             //09-03-16|0x046a
//***************************************************************************             //09-03-16|0x046b
    switch(BaseDictGetNextCmd(MailDictAddr, &command))                                    //09-03-16|0x046c
      {                                                                                   //09-03-16|0x046d
        case Success:                                                  break;             //09-03-16|0x046e
        case UserError:           TestSample(mail_get_next_2);    return(No);             //09-03-16|0x046f
        default:                                            ReturnSystemError             //09-03-16|0x0470
        }                                                                                 //09-03-16|0x0471
//---------------------------------------------------------------------------             //09-03-16|0x0472
    switch(command)                                                                       //09-03-16|0x0473
      {                                                                                   //09-03-16|0x0474
        case SD_ENTRY_NAME:        TestSample(mail_get_next_1);  return(Yes);             //09-03-16|0x0475
        default:                                            ReturnSystemError             //09-03-16|0x0476
        }                                                                                 //09-03-16|0x0477
}                                                                                         //09-03-16|0x0478
//                                                                                        //05-24-97|0x0478
//***************************************************************************             //10-01-03|0x047b
//***************************************************************************             //10-01-03|0x047c
//******                                                               ******             //10-01-03|0x047d
//******               mail_dict_control_read(Index)                   ******             //10-01-03|0x047e
//******                                                               ******             //10-01-03|0x047f
//***************************************************************************             //10-01-03|0x0480
//***************************************************************************             //10-01-03|0x0481
//*******************************************************************************         //10-29-97|0x0486
//*******************************************************************************         //10-29-97|0x0486
// mail_dict_control_read                                                                 //10-01-03|0x0486
//*******************************************************************************         //10-29-97|0x0486
//*******************************************************************************         //10-29-97|0x0486
UINT MAILDICT::mail_dict_control_read(                                                    //10-01-03|0x0486
    SINT Index                                                                            //10-01-03|0x0486
    ) {                                                                                   //10-01-03|0x0486
//*******************************************************************************         //10-29-97|0x0486
//***************************************************************************             //10-01-03|0x0489
//***                                                                     ***             //10-01-03|0x048a
//***  Do we already have the proper record in memory                     ***             //10-01-03|0x048b
//***                                                                     ***             //10-01-03|0x048c
//***************************************************************************             //10-01-03|0x048d
    if(Index != MailIndex)                                                                //10-01-03|0x048e
      {                                                                                   //10-01-03|0x048f
//***************************************************************************             //10-01-03|0x0490
//***                                                                     ***             //10-01-03|0x0491
//***  We do not have the proper record in memory                         ***             //10-01-03|0x0492
//***-------------------------------------------------------------------- ***             //10-01-03|0x0493
//***  Read the record                                                    ***             //10-01-03|0x0494
//***                                                                     ***             //10-01-03|0x0495
//***************************************************************************             //10-01-03|0x0496
        MailIndex         =  Index;                                                       //10-01-03|0x0497
        MailPosition      =  Index * MailSize;                                            //10-01-03|0x0498
//***************************************************************************             //10-01-03|0x0499
        switch(FileCommitBinary(MailFileAddr))                   _SwitchGroup             //10-01-03|0x049a
        switch(FileReadData(MailDataAddr,MailPosition,MailSize)) _SwitchGroup             //10-01-03|0x049b
        switch(FileRelease())                                    _SwitchGroup             //10-01-03|0x049c
        }                                                                                 //10-01-03|0x049d
//***************************************************************************             //10-01-03|0x049e
    if(MailIndex1   !=  MailIndex)                          ReturnSystemError             //10-01-03|0x049f
    if(MailIndex2   !=  MailIndex)                          ReturnSystemError             //10-01-03|0x04a0
    return_test(mail_dict_control_read_1);                                                //10-01-03|0x04a1
}                                                                                         //10-01-03|0x04a2
//                                                                                        //05-24-97|0x04a2
//***************************************************************************             //10-01-03|0x04a5
//***************************************************************************             //10-01-03|0x04a6
//******                                                               ******             //10-01-03|0x04a7
//******               mail_dict_control_write(Index)                  ******             //10-01-03|0x04a8
//******                                                               ******             //10-01-03|0x04a9
//***************************************************************************             //10-01-03|0x04aa
//***************************************************************************             //10-01-03|0x04ab
//*******************************************************************************         //10-29-97|0x04b0
//*******************************************************************************         //10-29-97|0x04b0
// mail_dict_control_write                                                                //10-01-03|0x04b0
//*******************************************************************************         //10-29-97|0x04b0
//*******************************************************************************         //10-29-97|0x04b0
UINT MAILDICT::mail_dict_control_write(                                                   //10-01-03|0x04b0
    SINT Index                                                                            //10-01-03|0x04b0
    ) {                                                                                   //10-01-03|0x04b0
//*******************************************************************************         //10-29-97|0x04b0
//***************************************************************************             //10-01-03|0x04b3
//***************************************************************************             //10-01-03|0x04b4
    MailIndex         =  Index;                                                           //10-01-03|0x04b5
    MailPosition      =  Index * MailSize;                                                //10-01-03|0x04b6
//***************************************************************************             //10-01-03|0x04b7
    MailIndex1        =  MailIndex;                                                       //10-01-03|0x04b8
    MailIndex2        =  MailIndex;                                                       //10-01-03|0x04b9
//***************************************************************************             //10-01-03|0x04ba
    switch(FileCommitBinary(MailFileAddr))                       _SwitchGroup             //10-01-03|0x04bb
    switch(FileWriteData(MailPosition, MailDataAddr, MailSize))  _SwitchGroup             //10-01-03|0x04bc
    switch(FileRelease())                                        _SwitchGroup             //10-01-03|0x04bd
    return_test(mail_dict_control_write_1);                                               //10-01-03|0x04be
}                                                                                         //10-01-03|0x04bf
//                                                                                        //05-24-97|0x04bf
//***************************************************************************             //10-01-03|0x04c2
//***************************************************************************             //10-01-03|0x04c3
//******                                                               ******             //10-01-03|0x04c4
//******               mail_dict_control_verify(Index)                 ******             //10-01-03|0x04c5
//******                                                               ******             //10-01-03|0x04c6
//***************************************************************************             //10-01-03|0x04c7
//***************************************************************************             //10-01-03|0x04c8
//*******************************************************************************         //10-29-97|0x04cd
//*******************************************************************************         //10-29-97|0x04cd
// mail_dict_control_verify                                                               //10-01-03|0x04cd
//*******************************************************************************         //10-29-97|0x04cd
//*******************************************************************************         //10-29-97|0x04cd
UINT MAILDICT::mail_dict_control_verify(                                                  //10-01-03|0x04cd
    SINT Index                                                                            //10-01-03|0x04cd
    ) {                                                                                   //10-01-03|0x04cd
//*******************************************************************************         //10-29-97|0x04cd
//***************************************************************************             //10-01-03|0x04d0
//***************************************************************************             //10-01-03|0x04d1
    if(MailIndex    != Index)                               ReturnSystemError             //10-01-03|0x04d2
    if(MailPosition != (Index * MailSize))                  ReturnSystemError             //10-01-03|0x04d3
//***************************************************************************             //10-01-03|0x04d4
    if(MailIndex1   !=  MailIndex)                          ReturnSystemError             //10-01-03|0x04d5
    if(MailIndex2   !=  MailIndex)                          ReturnSystemError             //10-01-03|0x04d6
//***************************************************************************             //10-01-03|0x04d7
    return_test(mail_dict_control_verify_1);                                              //10-01-03|0x04d8
}                                                                                         //10-01-03|0x04d9
//                                                                                        //05-24-97|0x04d9
//***************************************************************************             //09-03-16|0x04dc
//***************************************************************************             //09-03-16|0x04dd
//******                                                               ******             //09-03-16|0x04de
//******                       TEST WRAPPERS                           ******             //09-03-16|0x04df
//******                                                               ******             //09-03-16|0x04e0
//***************************************************************************             //09-03-16|0x04e1
//***************************************************************************             //09-03-16|0x04e2
//*******************************************************************************         //10-29-97|0x04e3
//*******************************************************************************         //10-29-97|0x04e3
// mail_dict_test_reset                                                                   //09-03-16|0x04e3
//*******************************************************************************         //10-29-97|0x04e3
//*******************************************************************************         //10-29-97|0x04e3
UINT MAILDICT::mail_dict_test_reset(void) {                                               //09-03-16|0x04e3
//*******************************************************************************         //10-29-97|0x04e3
//************************************************************************                //09-03-16|0x04e3
    switch(BasicTestReset())                                                              //09-03-16|0x04e3
      {                                                                                   //09-03-16|0x04e3
        case Success:                                     return(Success);                //09-03-16|0x04e3
        default:                                        ReturnSystemError;                //09-03-16|0x04e3
        }                                                                                 //09-03-16|0x04e3
}                                                                                         //09-03-16|0x04e3
//                                                                                        //05-24-97|0x04e3
//***************************************************************************             //09-03-16|0x04e4
//*******************************************************************************         //10-29-97|0x04e5
//*******************************************************************************         //10-29-97|0x04e5
// mail_dict_test_read                                                                    //09-03-16|0x04e5
//*******************************************************************************         //10-29-97|0x04e5
//*******************************************************************************         //10-29-97|0x04e5
UINT MAILDICT::mail_dict_test_read(void) {                                                //09-03-16|0x04e5
//*******************************************************************************         //10-29-97|0x04e5
//************************************************************************                //09-03-16|0x04e5
    switch(BasicTestRead(&test_samples[0], test_samples[0]))                              //09-03-16|0x04e5
      {                                                                                   //09-03-16|0x04e5
        case Success:                                     return(Success);                //09-03-16|0x04e5
        default:                                        ReturnSystemError;                //09-03-16|0x04e5
        }                                                                                 //09-03-16|0x04e5
}                                                                                         //09-03-16|0x04e5
//                                                                                        //05-24-97|0x04e5
//***************************************************************************             //09-03-16|0x04e6
//*******************************************************************************         //10-29-97|0x04e7
//*******************************************************************************         //10-29-97|0x04e7
// mail_dict_test_write                                                                   //09-03-16|0x04e7
//*******************************************************************************         //10-29-97|0x04e7
//*******************************************************************************         //10-29-97|0x04e7
UINT MAILDICT::mail_dict_test_write(void) {                                               //09-03-16|0x04e7
//*******************************************************************************         //10-29-97|0x04e7
//************************************************************************                //09-03-16|0x04e7
    switch(BasicTestWrite(&test_samples[0]))                                              //09-03-16|0x04e7
      {                                                                                   //09-03-16|0x04e7
        case Success:                                     return(Success);                //09-03-16|0x04e7
        default:                                        ReturnSystemError;                //09-03-16|0x04e7
        }                                                                                 //09-03-16|0x04e7
}                                                                                         //09-03-16|0x04e7
//                                                                                        //05-24-97|0x04e7
//***************************************************************************             //09-03-16|0x04e8
//*******************************************************************************         //10-29-97|0x04e9
//*******************************************************************************         //10-29-97|0x04e9
// mail_dict_test_report                                                                  //09-03-16|0x04e9
//*******************************************************************************         //10-29-97|0x04e9
//*******************************************************************************         //10-29-97|0x04e9
UINT MAILDICT::mail_dict_test_report(void) {                                              //09-03-16|0x04e9
//*******************************************************************************         //10-29-97|0x04e9
//************************************************************************                //09-03-16|0x04e9
    switch(BasicTestReport(&test_samples[0], "MAILDICT"))                                 //09-03-16|0x04e9
      {                                                                                   //09-03-16|0x04e9
        case Success:                                     return(Success);                //09-03-16|0x04e9
        default:                                        ReturnSystemError;                //09-03-16|0x04e9
        }                                                                                 //09-03-16|0x04e9
}                                                                                         //09-03-16|0x04e9
//                                                                                        //05-24-97|0x04e9
//***************************************************************************             //09-03-16|0x04ec
//***************************************************************************             //09-03-16|0x04ed
//******                                                               ******             //09-03-16|0x04ee
//******                        constructor                            ******             //09-03-16|0x04ef
//******                                                               ******             //09-03-16|0x04f0
//***************************************************************************             //09-03-16|0x04f1
//***************************************************************************             //09-03-16|0x04f2
//*******************************************************************************         //10-29-97|0x04f3
//*******************************************************************************         //10-29-97|0x04f3
// CONSTRUCTOR                                                                            //09-03-16|0x04f3
//*******************************************************************************         //10-29-97|0x04f3
//*******************************************************************************         //10-29-97|0x04f3
MAILDICT::MAILDICT() {                                                                    //09-03-16|0x04f3
//***************************************************************************             //09-03-16|0x04f4
//***************************************************************************             //09-03-16|0x04f5
    { ULONG i;                                                                            //09-03-16|0x04f6
      test_samples[NoTestSamples] = TestIndex;                                            //09-03-16|0x04f6
      i = 1;                                                                              //09-03-16|0x04f6
      while(i<TestIndex)                                                                  //09-03-16|0x04f6
        {                                                                                 //09-03-16|0x04f6
          test_samples[i] = 0;                                                            //09-03-16|0x04f6
          ++i;                                                                            //09-03-16|0x04f6
          }                                                                               //09-03-16|0x04f6
      }                                                                                   //09-03-16|0x04f6
//***************************************************************************             //09-03-16|0x04f7
}                                                                                         //09-03-16|0x04f8
//                                                                                        //05-24-97|0x04f8
//*******************************************************************************         //05-24-97|0x04fc
//*******************************************************************************         //05-24-97|0x04fc
//****                       END OF FILE                                     ****         //05-24-97|0x04fc
//*******************************************************************************         //05-24-97|0x04fc
//*******************************************************************************         //05-24-97|0x04fc
