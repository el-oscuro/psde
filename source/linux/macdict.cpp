//*****************************************************************************           //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
//                                                                                        //06-07-12|0x000b
// MACRO DICTIONARY_MANAGER                                                               //06-07-12|0x000b
//                                                                                        //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
//  Copyright: 2006 Robert H. Adams                                                       //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
//  The purpose of this program as well as instructions regarding its use is              //06-07-12|0x000b
//  defined in the associated manual.                                                     //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
//  This program is free software; you can redistribute it and/or modify                  //06-07-12|0x000b
//  it under the terms of the GNU General Public License as published by                  //06-07-12|0x000b
//  the Free Software Foundation; either version 2 of the License, or                     //06-07-12|0x000b
//  (at your option) any later version.                                                   //06-07-12|0x000b
//                                                                                        //06-07-12|0x000b
//  This program is distributed in the hope that it will be useful,                       //06-07-12|0x000b
//  but WITHOUT ANY WARRANTY; without even the implied warranty of                        //06-07-12|0x000b
//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                         //06-07-12|0x000b
//  GNU General Public License for more details.                                          //06-07-12|0x000b
//                                                                                        //06-07-12|0x000b
//  You should have received a copy of the GNU General Public License                     //06-07-12|0x000b
//  along with this program; if not, write to the Free Software                           //06-07-12|0x000b
//  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA., 02110-1301            //06-07-12|0x000b
//  USA                                                                                   //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
//  For further information, please contact Robert Adams:                                 //06-07-12|0x000b
//     EMail:    robert.adams@whatifwe.com                                                //06-07-12|0x000b
//     Mail:     PO Box 156, Sun Valley, Ca. 91353-0155, USA                              //06-07-12|0x000b
//  Or visit the website, "www.whatifwe.com".                                             //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
//*****************************************************************************           //06-07-12|0x000b
#ifdef WIN31_SYSTEM                                                                       //05-24-97|0x000c
#include "precwn31.h"                                                                     //05-24-97|0x000c
#endif                                                                                    //05-24-97|0x000c
#ifdef WIN95_SYSTEM                                                                       //05-24-97|0x000c
#include "precwn95.h"                                                                     //05-24-97|0x000c
#endif                                                                                    //05-24-97|0x000c
#ifdef MSDOS_SYSTEM                                                                       //05-24-97|0x000c
#include "precdos.h"                                                                      //05-24-97|0x000c
#endif                                                                                    //05-24-97|0x000c
#include "prechost.h"                                                                     //05-24-97|0x000c
#include "macdict.h"                                                                      //06-07-12|0x000c
#include "macdict.hxx"                                                                    //06-07-12|0x000c
#include "macdict.hpp"                                                                    //06-07-12|0x000c
#include "precutil.h"                                                                     //11-05-30|0x000d
#include "precdiag.h"                                                                     //06-07-12|0x000e
#include "basedict.h"                                                                     //98-03-30|0x000f
#include "crypto.h"                                                                       //11-02-26|0x0010
#include "global.hxx"                                                                     //06-11-14|0x0011
#define StrLen(i) strlen(i)                                                               //06-07-12|0x0019
#define StrCat(i,j) strcat(i,j)                                                           //06-07-12|0x0019
#define StrCpy(i,j) strcpy(i,j)                                                           //06-07-12|0x0019
#define StrCmp(i,j) Str_Comp((SCHAR_FAR)i,j,256)                                          //06-07-12|0x0019
#define StrRChr(i,j) strrchr(i,j)                                                         //06-07-12|0x0019
#define StrToByteInt(i,j) GetInteger(i,&j,0xff)                                           //06-07-12|0x0019
#define StrToInt(i,j) GetInteger(i,&j,0xffff)                                             //06-07-12|0x0019
#define StrToLongInt(i,j) GetInteger(i,&j,0xffffffffL)                                    //06-07-12|0x0019
#define StrToByteHex(i,j) GetHex(i,&j,1)                                                  //06-07-12|0x0019
#define StrToHex(i,j) GetHex(i,&j,2)                                                      //06-07-12|0x0019
#define StrToLongHex(i,j) GetHex(i,&j,4)                                                  //06-07-12|0x0019
#define FindName(i) strrchr(i, '/')                                                       //06-07-12|0x0019
#define Allocate(k) (k##_FAR) calloc(1,sizeof(k))                                         //06-07-12|0x001a
#define Free(k) free(k)                                                                   //06-07-12|0x001a
#define MemSet(i,j,k) memset(i,j,k)                                                       //06-07-12|0x001a
#define MemCCpy(i,j,k,l) Mem_C_Copy((UCHAR_FAR) i, (UCHAR_FAR) j,k,l)                     //06-07-12|0x001a
#define MemCpy(i,j,k) memcpy(i,j,k)                                                       //06-07-12|0x001a
#define LineEnd 0x0d                                                                      //06-07-12|0x001a
MACDICT mac_dict;                                                                         //06-07-12|0x0043
static UINT test_samples[TestIndex];                                                      //06-07-12|0x0053
//***************************************************************************             //06-07-12|0x005b
//***************************************************************************             //06-07-12|0x005c
//******                                                               ******             //06-07-12|0x005d
//******                       mac_dict_allocate                       ******             //06-07-12|0x005e
//******                                                               ******             //06-07-12|0x005f
//***************************************************************************             //06-07-12|0x0060
//***************************************************************************             //06-07-12|0x0061
//*******************************************************************************         //10-29-97|0x0068
//*******************************************************************************         //10-29-97|0x0068
// mac_dict_allocate                                                                      //06-07-12|0x0068
//*******************************************************************************         //10-29-97|0x0068
//*******************************************************************************         //10-29-97|0x0068
UINT MACDICT::mac_dict_allocate(void) {                                                   //06-07-12|0x0068
//*******************************************************************************         //10-29-97|0x0068
//***************************************************************************             //06-07-12|0x006c
//***************************************************************************             //06-07-12|0x006d
    TestSample(mac_dict_allocate_1);                                                      //06-07-12|0x006e
    if(dict_addr                         != 0)              ReturnSystemError             //06-07-12|0x006f
    if((dict_addr = Allocate(DICT_DATA)) == 0)              ReturnSystemError             //06-07-12|0x0070
//***************************************************************************             //06-07-12|0x0071
    return(Success);                                                                      //06-07-12|0x0072
}                                                                                         //06-07-12|0x0073
//                                                                                        //05-24-97|0x0073
//***************************************************************************             //06-07-12|0x0076
//***************************************************************************             //06-07-12|0x0077
//******                                                               ******             //06-07-12|0x0078
//******                         mac_dict_free                         ******             //06-07-12|0x0079
//******                                                               ******             //06-07-12|0x007a
//***************************************************************************             //06-07-12|0x007b
//***************************************************************************             //06-07-12|0x007c
//*******************************************************************************         //10-29-97|0x0080
//*******************************************************************************         //10-29-97|0x0080
// mac_dict_free                                                                         //06-07-12|0x0080
//*******************************************************************************         //10-29-97|0x0080
//*******************************************************************************         //10-29-97|0x0080
UINT MACDICT::mac_dict_free(void) {                                                      //06-07-12|0x0080
//*******************************************************************************         //10-29-97|0x0080
//***************************************************************************             //06-07-12|0x0084
//***************************************************************************             //06-07-12|0x0085
    TestSample(mac_dict_free_1);                                                          //06-07-12|0x0086
    if(dict_addr                     == 0)                  ReturnSystemError             //06-07-12|0x0087
    Free(dict_addr);                                                                      //06-07-12|0x0088
    dict_addr = 0;                                                                        //06-07-12|0x0089
//***************************************************************************             //06-07-12|0x008a
    return(Success);                                                                      //06-07-12|0x008b
}                                                                                         //06-07-12|0x008c
//                                                                                        //05-24-97|0x008c
//***************************************************************************             //06-08-18|0x008f
//***************************************************************************             //06-08-18|0x0090
//******                                                               ******             //06-08-18|0x0091
//******               mac_dict_name(Name, Extent)                     ******             //06-08-18|0x0092
//******                                                               ******             //06-08-18|0x0093
//***************************************************************************             //06-08-18|0x0094
//***************************************************************************             //06-08-18|0x0095
//*******************************************************************************         //10-29-97|0x009a
//*******************************************************************************         //10-29-97|0x009a
// mac_dict_name                                                                          //06-08-18|0x009a
//*******************************************************************************         //10-29-97|0x009a
//*******************************************************************************         //10-29-97|0x009a
UINT MACDICT::mac_dict_name(                                                              //06-08-18|0x009a
    SCHAR_FAR Name,                                                                       //06-08-18|0x009a
    SCHAR_FAR Extent                                                                      //06-08-18|0x009a
    ) {                                                                                   //06-08-18|0x009a
//*******************************************************************************         //10-29-97|0x009a
//***************************************************************************             //06-08-18|0x009e
//***************************************************************************             //06-08-18|0x009f
    if(dict_addr == 0)                                      ReturnSystemError             //06-08-18|0x00a0
//***************************************************************************             //11-02-26|0x00a1
    switch(BaseDictInitial(dict_addr, Name, Extent))             _SwitchGroup             //06-08-18|0x00a2
//***************************************************************************             //11-02-26|0x00a3
    return_test(mac_dict_name_1);                                                         //06-08-18|0x00a4
}                                                                                         //06-08-18|0x00a5
//                                                                                        //05-24-97|0x00a5
//***************************************************************************             //06-08-18|0x00a8
//***************************************************************************             //06-08-18|0x00a9
//******                                                               ******             //06-08-18|0x00aa
//******               mac_dict_exists(TimeAddr)                       ******             //06-08-18|0x00ab
//******                                                               ******             //06-08-18|0x00ac
//***************************************************************************             //06-08-18|0x00ad
//***************************************************************************             //06-08-18|0x00ae
//*******************************************************************************         //10-29-97|0x00b4
//*******************************************************************************         //10-29-97|0x00b4
// mac_dict_exists                                                                        //06-08-18|0x00b4
//*******************************************************************************         //10-29-97|0x00b4
//*******************************************************************************         //10-29-97|0x00b4
UINT MACDICT::mac_dict_exists(                                                            //06-08-18|0x00b4
    ULONG_FAR TimeFar                                                                     //06-08-18|0x00b4
    ) {                                                                                   //06-08-18|0x00b4
//*******************************************************************************         //10-29-97|0x00b4
//***************************************************************************             //06-08-18|0x00b8
//***************************************************************************             //06-08-18|0x00b9
    if(dict_addr == 0)                                      ReturnSystemError             //06-08-18|0x00ba
    switch(BaseDictExists(dict_addr, TimeFar))                   _SwitchGroup             //06-08-18|0x00bb
//***************************************************************************             //06-08-18|0x00bc
    return_test(mac_dict_exists_1);                                                       //06-08-18|0x00bd
}                                                                                         //06-08-18|0x00be
//                                                                                        //05-24-97|0x00be
//***************************************************************************             //06-08-18|0x00c1
//***************************************************************************             //06-08-18|0x00c2
//******                                                               ******             //06-08-18|0x00c3
//******               mac_dict_create(BridgeName)                     ******             //06-08-18|0x00c4
//******                                                               ******             //06-08-18|0x00c5
//***************************************************************************             //06-08-18|0x00c6
//***************************************************************************             //06-08-18|0x00c7
//*******************************************************************************         //10-29-97|0x00cc
//*******************************************************************************         //10-29-97|0x00cc
// mac_dict_create                                                                        //06-08-18|0x00cc
//*******************************************************************************         //10-29-97|0x00cc
//*******************************************************************************         //10-29-97|0x00cc
UINT MACDICT::mac_dict_create(                                                            //06-08-18|0x00cc
    STRING_DATA_FAR String                                                                //06-08-18|0x00cc
    ) {                                                                                   //06-08-18|0x00cc
//*******************************************************************************         //10-29-97|0x00cc
//***************************************************************************             //06-08-18|0x00d0
//***************************************************************************             //06-08-18|0x00d1
    if(dict_addr == 0)                                      ReturnSystemError             //06-08-18|0x00d2
    switch(BaseDictInitialHash(dict_addr))                       _SwitchGroup             //06-08-18|0x00d3
//***************************************************************************             //06-08-18|0x00d4
    switch(MacDictLoadClass(String))                                                      //07-04-27|0x00d5
      {                                                                                   //06-08-18|0x00d6
        case Success:                                                  break;             //07-01-17|0x00d7
        default:                                            ReturnSystemError             //06-08-18|0x00d8
        }                                                                                 //06-08-18|0x00d9
//***************************************************************************             //07-07-17|0x00da
    switch(MacDictLoadBridge(String, I_CLASS_BRIDGE))                                     //07-07-17|0x00db
      {                                                                                   //07-07-17|0x00dc
        case Success:                                                  break;             //07-07-17|0x00dd
        default:                                            ReturnSystemError             //07-07-17|0x00de
        }                                                                                 //07-07-17|0x00df
//***************************************************************************             //06-09-06|0x00e0
    return_test(mac_dict_create_1);                                                       //07-01-17|0x00e1
}                                                                                         //06-08-18|0x00e2
//                                                                                        //05-24-97|0x00e2
//***************************************************************************             //06-09-06|0x00e5
//***************************************************************************             //06-09-06|0x00e6
//******                                                               ******             //06-09-06|0x00e7
//******               mac_dict_open(BridgeName)                       ******             //06-09-06|0x00e8
//******                                                               ******             //06-09-06|0x00e9
//***************************************************************************             //06-09-06|0x00ea
//***************************************************************************             //06-09-06|0x00eb
//*******************************************************************************         //10-29-97|0x00f0
//*******************************************************************************         //10-29-97|0x00f0
// mac_dict_open                                                                          //06-09-06|0x00f0
//*******************************************************************************         //10-29-97|0x00f0
//*******************************************************************************         //10-29-97|0x00f0
UINT MACDICT::mac_dict_open(                                                              //06-09-06|0x00f0
    STRING_DATA_FAR String                                                                //06-09-06|0x00f0
    ) {                                                                                   //06-09-06|0x00f0
//*******************************************************************************         //10-29-97|0x00f0
//***************************************************************************             //06-09-06|0x00f4
//***************************************************************************             //06-09-06|0x00f5
    if(dict_addr == 0)                                      ReturnSystemError             //06-09-06|0x00f6
    switch(BaseDictReadHash(dict_addr))                          _SwitchGroup             //06-09-06|0x00f7
//***************************************************************************             //06-09-06|0x00f8
    switch(MacDictVerifyClass(String))                                                    //07-04-27|0x00f9
      {                                                                                   //06-11-14|0x00fa
        case Success:                           return_test(mac_dict_open_1);             //07-04-27|0x00fb
        case UserError:                                    return(UserError);             //06-11-14|0x00fc
        default:                                            ReturnSystemError             //06-11-14|0x00fd
        }                                                                                 //06-11-14|0x00fe
}                                                                                         //06-09-06|0x00ff
//                                                                                        //05-24-97|0x00ff
//***************************************************************************             //06-09-06|0x0102
//***************************************************************************             //06-09-06|0x0103
//******                                                               ******             //06-09-06|0x0104
//******               mac_dict_append(BridgeName)                     ******             //06-09-06|0x0105
//******                                                               ******             //06-09-06|0x0106
//***************************************************************************             //06-09-06|0x0107
//***************************************************************************             //06-09-06|0x0108
//*******************************************************************************         //10-29-97|0x010c
//*******************************************************************************         //10-29-97|0x010c
// mac_dict_append                                                                        //06-09-06|0x010c
//*******************************************************************************         //10-29-97|0x010c
//*******************************************************************************         //10-29-97|0x010c
UINT MACDICT::mac_dict_append(void) {                                                     //06-09-06|0x010c
//*******************************************************************************         //10-29-97|0x010c
//***************************************************************************             //06-09-06|0x0110
//***************************************************************************             //06-09-06|0x0111
    if(dict_addr == 0)                                      ReturnSystemError             //06-09-06|0x0112
    switch(BaseDictAppendHash(dict_addr))                        _SwitchGroup             //06-09-06|0x0113
//***************************************************************************             //06-09-06|0x0114
    return_test(mac_dict_append_1);                                                       //06-09-06|0x0115
}                                                                                         //06-09-06|0x0116
//                                                                                        //05-24-97|0x0116
//***************************************************************************             //06-08-18|0x0119
//***************************************************************************             //06-08-18|0x011a
//******                                                               ******             //06-08-18|0x011b
//******               mac_dict_close()                                ******             //06-08-18|0x011c
//******                                                               ******             //06-08-18|0x011d
//***************************************************************************             //06-08-18|0x011e
//***************************************************************************             //06-08-18|0x011f
//*******************************************************************************         //10-29-97|0x0123
//*******************************************************************************         //10-29-97|0x0123
// mac_dict_close                                                                         //06-08-18|0x0123
//*******************************************************************************         //10-29-97|0x0123
//*******************************************************************************         //10-29-97|0x0123
UINT MACDICT::mac_dict_close(void) {                                                      //06-08-18|0x0123
//*******************************************************************************         //10-29-97|0x0123
//***************************************************************************             //06-08-18|0x0127
//***************************************************************************             //06-08-18|0x0128
    if(dict_addr == 0)                                      ReturnSystemError             //06-08-18|0x0129
//***************************************************************************             //11-02-14|0x012a
    switch(BaseDictClose(dict_addr))                             _SwitchGroup             //06-08-18|0x012b
//***************************************************************************             //11-02-14|0x012c
    return_test(mac_dict_close_1);                                                        //06-08-18|0x012d
}                                                                                         //06-08-18|0x012e
//                                                                                        //05-24-97|0x012e
//***************************************************************************             //07-03-21|0x0131
//***************************************************************************             //07-03-21|0x0132
//******                                                               ******             //07-03-21|0x0133
//******               mac_dict_emergency_close()                      ******             //07-03-21|0x0134
//******                                                               ******             //07-03-21|0x0135
//***************************************************************************             //07-03-21|0x0136
//***************************************************************************             //07-03-21|0x0137
//*******************************************************************************         //10-29-97|0x013b
//*******************************************************************************         //10-29-97|0x013b
// mac_dict_emergency_close                                                               //07-03-21|0x013b
//*******************************************************************************         //10-29-97|0x013b
//*******************************************************************************         //10-29-97|0x013b
UINT MACDICT::mac_dict_emergency_close(void) {                                            //07-03-21|0x013b
//*******************************************************************************         //10-29-97|0x013b
//***************************************************************************             //07-03-21|0x013f
//***************************************************************************             //07-03-21|0x0140
    if(dict_addr == 0)                                      ReturnSystemError             //07-03-21|0x0141
//***************************************************************************             //11-02-14|0x0142
    switch(BaseDictCloseEmergency(dict_addr))                    _SwitchGroup             //07-03-21|0x0143
//***************************************************************************             //07-03-21|0x0144
    return_test(mac_dict_emergency_close_1);                                              //07-03-21|0x0145
}                                                                                         //07-03-21|0x0146
//                                                                                        //05-24-97|0x0146
//***************************************************************************             //06-09-04|0x0149
//***************************************************************************             //06-09-04|0x014a
//******                                                               ******             //06-09-04|0x014b
//******               mac_dict_delete()                               ******             //06-09-04|0x014c
//******                                                               ******             //06-09-04|0x014d
//***************************************************************************             //06-09-04|0x014e
//***************************************************************************             //06-09-04|0x014f
//*******************************************************************************         //10-29-97|0x0153
//*******************************************************************************         //10-29-97|0x0153
// mac_dict_delete                                                                        //06-09-04|0x0153
//*******************************************************************************         //10-29-97|0x0153
//*******************************************************************************         //10-29-97|0x0153
UINT MACDICT::mac_dict_delete(void) {                                                     //06-09-04|0x0153
//*******************************************************************************         //10-29-97|0x0153
//***************************************************************************             //06-09-04|0x0157
//***************************************************************************             //06-09-04|0x0158
    if(dict_addr == 0)                                      ReturnSystemError             //06-09-04|0x0159
    switch(BaseDictDeleteDict(dict_addr))                        _SwitchGroup             //06-09-04|0x015a
//***************************************************************************             //06-09-04|0x015b
    return_test(mac_dict_delete_1);                                                       //06-09-04|0x015c
}                                                                                         //06-09-04|0x015d
//                                                                                        //05-24-97|0x015d
//***************************************************************************             //06-08-18|0x0160
//***************************************************************************             //06-08-18|0x0161
//******                                                               ******             //06-08-18|0x0162
//******               mac_dict_complete()                             ******             //06-08-18|0x0163
//******                                                               ******             //06-08-18|0x0164
//***************************************************************************             //06-08-18|0x0165
//***************************************************************************             //06-08-18|0x0166
//*******************************************************************************         //10-29-97|0x016a
//*******************************************************************************         //10-29-97|0x016a
// mac_dict_complete                                                                      //06-08-18|0x016a
//*******************************************************************************         //10-29-97|0x016a
//*******************************************************************************         //10-29-97|0x016a
UINT MACDICT::mac_dict_complete(void) {                                                   //06-08-18|0x016a
//*******************************************************************************         //10-29-97|0x016a
//***************************************************************************             //06-08-18|0x016e
//***************************************************************************             //06-08-18|0x016f
    if(dict_addr == 0)                                      ReturnSystemError             //06-08-18|0x0170
    switch(BaseDictAppendHash(dict_addr))                        _SwitchGroup             //06-08-18|0x0171
    switch(BaseDictComplete(dict_addr))                          _SwitchGroup             //06-08-18|0x0172
    switch(BaseDictClose(dict_addr))                             _SwitchGroup             //06-08-18|0x0173
//***************************************************************************             //06-08-18|0x0174
    return_test(mac_dict_complete_1);                                                     //06-08-18|0x0175
}                                                                                         //06-08-18|0x0176
//                                                                                        //05-24-97|0x0176
//***************************************************************************             //06-11-13|0x0179
//***************************************************************************             //06-11-13|0x017a
//******                                                               ******             //06-11-13|0x017b
//******               mac_dict_connect_header(InputHashAddr)          ******             //06-11-13|0x017c
//******                                                               ******             //06-11-13|0x017d
//***************************************************************************             //06-11-13|0x017e
//***************************************************************************             //06-11-13|0x017f
//*******************************************************************************         //10-29-97|0x0184
//*******************************************************************************         //10-29-97|0x0184
// mac_dict_connect_header                                                                //07-01-23|0x0184
//*******************************************************************************         //10-29-97|0x0184
//*******************************************************************************         //10-29-97|0x0184
UINT MACDICT::mac_dict_connect_header(                                                    //07-01-23|0x0184
    DICT_HASH_FAR InputHashFar,                                                           //07-01-23|0x0184
    SLONG InputLength                                                                     //07-01-23|0x0184
    ) {                                                                                   //07-01-23|0x0184
//*******************************************************************************         //10-29-97|0x0184
//***************************************************************************             //06-11-13|0x0186
//***************************************************************************             //06-11-13|0x0187
    if(dict_addr == 0)                                      ReturnSystemError             //06-11-13|0x0188
    switch(BaseDictConnect(dict_addr,InputHashFar,InputLength))  _SwitchGroup             //07-01-23|0x0189
//***************************************************************************             //06-11-13|0x018a
    return_test(mac_dict_connect_header_1);                                               //06-11-13|0x018b
}                                                                                         //06-11-13|0x018c
//                                                                                        //05-24-97|0x018c
//***************************************************************************             //06-11-14|0x018f
//***************************************************************************             //06-11-14|0x0190
//******                                                               ******             //06-11-14|0x0191
//******               mac_dict_write_record(InputHashAddr)            ******             //06-11-14|0x0192
//******                                                               ******             //06-11-14|0x0193
//***************************************************************************             //06-11-14|0x0194
//***************************************************************************             //06-11-14|0x0195
//*******************************************************************************         //10-29-97|0x019a
//*******************************************************************************         //10-29-97|0x019a
// mac_dict_write_record                                                                  //06-11-14|0x019a
//*******************************************************************************         //10-29-97|0x019a
//*******************************************************************************         //10-29-97|0x019a
UINT MACDICT::mac_dict_write_record(                                                      //06-11-14|0x019a
    DICT_RECORD_FAR RecordFar                                                             //06-11-14|0x019a
    ) {                                                                                   //06-11-14|0x019a
//*******************************************************************************         //10-29-97|0x019a
//***************************************************************************             //06-11-14|0x019c
//***************************************************************************             //06-11-14|0x019d
    if(dict_addr == 0)                                      ReturnSystemError             //06-11-14|0x019e
    switch(BaseDictWriteRecord(dict_addr, RecordFar))            _SwitchGroup             //06-11-14|0x019f
//***************************************************************************             //06-11-14|0x01a0
    return_test(mac_dict_write_record_1);                                                 //06-11-14|0x01a1
}                                                                                         //06-11-14|0x01a2
//                                                                                        //05-24-97|0x01a2
//***************************************************************************             //07-04-27|0x01a5
//***************************************************************************             //07-04-27|0x01a6
//******                                                               ******             //07-04-27|0x01a7
//******               mac_dict_load_class(InputString)                ******             //07-04-27|0x01a8
//******                                                               ******             //07-04-27|0x01a9
//***************************************************************************             //07-04-27|0x01aa
//***************************************************************************             //07-04-27|0x01ab
//*******************************************************************************         //10-29-97|0x01b0
//*******************************************************************************         //10-29-97|0x01b0
// mac_dict_load_class                                                                    //07-04-27|0x01b0
//*******************************************************************************         //10-29-97|0x01b0
//*******************************************************************************         //10-29-97|0x01b0
UINT MACDICT::mac_dict_load_class(                                                        //07-04-27|0x01b0
    STRING_DATA_FAR Addr                                                                  //07-04-27|0x01b0
    ) {                                                                                   //07-04-27|0x01b0
//*******************************************************************************         //10-29-97|0x01b0
//***************************************************************************             //07-04-27|0x01b4
//***************************************************************************             //07-04-27|0x01b5
  STRING_DATA work;                                                                  //07-04-27|0x01b6
//***************************************************************************             //07-04-27|0x01b7
//***************************************************************************             //07-04-27|0x01b8
    if(dict_addr      == 0)                                 ReturnSystemError             //07-04-27|0x01b9
//***************************************************************************             //07-04-27|0x01ba
//***************************************************************************             //07-04-27|0x01bb
    MemSet(&work, 0x00, sizeof(STRING_DATA));                                             //07-04-27|0x01bc
    StrCpy(WorkLineAddr, "CLASS_NAME");                                                   //07-04-27|0x01bd
    WorkMacroLineNo = AddrMacroLineNo;                                                    //07-09-21|0x01be
    WorkLength      = 10;                                                                 //07-04-27|0x01bf
    WorkType        = I_CLASS_NAME;                                                       //07-04-27|0x01c0
    if(WorkChar(WorkLength) != 0)                          ReturnSystemError;             //07-04-27|0x01c1
//***************************************************************************             //07-04-27|0x01c2
    switch(BaseDictBeginEntry(dict_addr, &work, MC_CLASS_NAME, I_CLASS_NAME))             //07-04-27|0x01c3
      {                                                                                   //07-04-27|0x01c4
        case Success:                                                  break;             //07-04-27|0x01c5
        case UserError:                                    return(UserError);             //07-04-27|0x01c6
        default:                                            ReturnSystemError             //07-04-27|0x01c7
        }                                                                                 //07-04-27|0x01c8
//***************************************************************************             //07-04-27|0x01c9
    if(AddrLength >  80)   ReturnFinish("Class Name has more than 80 chars");             //07-04-28|0x01ca
//---------------------------------------------------------------------------             //07-04-28|0x01cb
    if(AddrChar(AddrLength) != 0)                          ReturnSystemError;             //07-04-28|0x01cc
//---------------------------------------------------------------------------             //07-04-28|0x01cd
    AddrType     = I_CLASS_BRIDGE;                                                        //07-07-17|0x01ce
//***************************************************************************             //07-04-28|0x01cf
    switch(BaseDictAddArg(dict_addr, Addr, AddrType))                                     //07-04-27|0x01d0
      {                                                                                   //07-04-27|0x01d1
        case Success:                                                  break;             //07-04-27|0x01d2
        default:                                            ReturnSystemError             //07-04-27|0x01d3
        }                                                                                 //07-04-27|0x01d4
//***************************************************************************             //07-04-27|0x01d5
    switch(BaseDictEndEntry(dict_addr))                          _SwitchGroup             //07-04-27|0x01d6
    return_test(mac_dict_load_class_1);                                                   //07-04-27|0x01d7
}                                                                                         //07-04-27|0x01d8
//                                                                                        //05-24-97|0x01d8
//***************************************************************************             //11-02-18|0x01db
//***************************************************************************             //11-02-18|0x01dc
//******                                                               ******             //11-02-18|0x01dd
//******               mac_dict_load_cert(InputString)                 ******             //11-02-18|0x01de
//******                                                               ******             //11-02-18|0x01df
//***************************************************************************             //11-02-18|0x01e0
//***************************************************************************             //11-02-18|0x01e1
//*******************************************************************************         //10-29-97|0x01e6
//*******************************************************************************         //10-29-97|0x01e6
// mac_dict_load_cert                                                                     //11-02-18|0x01e6
//*******************************************************************************         //10-29-97|0x01e6
//*******************************************************************************         //10-29-97|0x01e6
UINT MACDICT::mac_dict_load_cert(                                                         //11-02-18|0x01e6
    STRING_DATA_FAR Addr                                                                  //11-02-18|0x01e6
    ) {                                                                                   //11-02-18|0x01e6
//*******************************************************************************         //10-29-97|0x01e6
//***************************************************************************             //11-02-18|0x01ea
//***************************************************************************             //11-02-18|0x01eb
  STRING_DATA work;                                                                  //11-02-18|0x01ec
//***************************************************************************             //11-02-18|0x01ed
//***************************************************************************             //11-02-18|0x01ee
    if(dict_addr      == 0)                                 ReturnSystemError             //11-02-18|0x01ef
//***************************************************************************             //11-02-18|0x01f0
//***************************************************************************             //11-02-18|0x01f1
    MemSet(&work, 0x00, sizeof(STRING_DATA));                                             //11-02-18|0x01f2
    StrCpy(WorkLineAddr, "CLASS_STATUS");                                                 //11-02-18|0x01f3
    WorkLength      = 12;                                                                 //11-02-18|0x01f4
    WorkType        = I_CERTIFICATION;                                                    //11-02-18|0x01f5
    if(WorkChar(WorkLength) != 0)                          ReturnSystemError;             //11-02-18|0x01f6
//***************************************************************************             //11-02-18|0x01f7
    switch(                                                                               //11-02-18|0x01f8
      BaseDictBeginEntry                                                                  //11-02-18|0x01f9
        (                                                                                 //11-02-18|0x01fa
          dict_addr, &work, MC_CERTIFICATION, I_CERTIFICATION                             //11-02-18|0x01fb
          )                                                                               //11-02-18|0x01fc
      )                                                                                   //11-02-18|0x01fd
      {                                                                                   //11-02-18|0x01fe
        case Success:                                                  break;             //11-02-18|0x01ff
        case UserError:                                    return(UserError);             //11-02-18|0x0200
        default:                                            ReturnSystemError             //11-02-18|0x0201
        }                                                                                 //11-02-18|0x0202
//***************************************************************************             //11-02-18|0x0203
//***************************************************************************             //11-02-18|0x0204
    MemSet(&work, 0x00, sizeof(STRING_DATA));                                             //11-02-18|0x0205
//***************************************************************************             //11-02-18|0x0206
    WorkType      = I_CERTIFICATION;                                                      //11-02-18|0x0207
//***************************************************************************             //11-02-18|0x0208
    switch(BaseDictAddArg(dict_addr, Addr,  I_CERTIFICATION))                             //11-02-18|0x0209
      {                                                                                   //11-02-18|0x020a
        case Success:                                                  break;             //11-02-18|0x020b
        default:                                            ReturnSystemError             //11-02-18|0x020c
        }                                                                                 //11-02-18|0x020d
//***************************************************************************             //11-02-18|0x020e
    switch(BaseDictEndEntry(dict_addr))                          _SwitchGroup             //11-02-18|0x020f
    return_test(mac_dict_load_cert_1);                                                    //11-02-18|0x0210
}                                                                                         //11-02-18|0x0211
//                                                                                        //05-24-97|0x0211
//***************************************************************************             //07-04-27|0x0214
//***************************************************************************             //07-04-27|0x0215
//******                                                               ******             //07-04-27|0x0216
//******               mac_dict_load_bridge(InputString)               ******             //07-04-27|0x0217
//******                                                               ******             //07-04-27|0x0218
//***************************************************************************             //07-04-27|0x0219
//***************************************************************************             //07-04-27|0x021a
//*******************************************************************************         //10-29-97|0x021f
//*******************************************************************************         //10-29-97|0x021f
// mac_dict_load_bridge                                                                   //07-05-24|0x021f
//*******************************************************************************         //10-29-97|0x021f
//*******************************************************************************         //10-29-97|0x021f
UINT MACDICT::mac_dict_load_bridge(                                                       //07-05-24|0x021f
    STRING_DATA_FAR Addr,                                                                 //07-05-24|0x021f
    UINT BridgeType                                                                       //07-05-24|0x021f
    ) {                                                                                   //07-05-24|0x021f
//*******************************************************************************         //10-29-97|0x021f
//***************************************************************************             //07-04-27|0x0223
//***************************************************************************             //07-04-27|0x0224
    switch(BaseDictBeginEntry(dict_addr, Addr, MC_BRIDGE_NAME, BridgeType))               //07-05-24|0x0225
      {                                                                                   //07-04-27|0x0226
        case Success:                                                  break;             //07-04-27|0x0227
        case UserError:                                    return(UserError);             //07-04-27|0x0228
        default:                                            ReturnSystemError             //07-04-27|0x0229
        }                                                                                 //07-04-27|0x022a
    switch(BaseDictEndEntry(dict_addr))                          _SwitchGroup             //07-04-27|0x022b
    return_test(mac_dict_load_bridge_1);                                                  //07-04-27|0x022c
}                                                                                         //07-04-27|0x022d
//                                                                                        //05-24-97|0x022d
//***************************************************************************             //07-04-27|0x0230
//***************************************************************************             //07-04-27|0x0231
//******                                                               ******             //07-04-27|0x0232
//******               mac_dict_initial_bridge(InputString)            ******             //07-04-27|0x0233
//******                                                               ******             //07-04-27|0x0234
//***************************************************************************             //07-04-27|0x0235
//***************************************************************************             //07-04-27|0x0236
//*******************************************************************************         //10-29-97|0x023c
//*******************************************************************************         //10-29-97|0x023c
// mac_dict_initial_bridge                                                                //07-05-24|0x023c
//*******************************************************************************         //10-29-97|0x023c
//*******************************************************************************         //10-29-97|0x023c
UINT MACDICT::mac_dict_initial_bridge(                                                    //07-05-24|0x023c
    STRING_DATA_FAR Addr,                                                                 //07-05-24|0x023c
    UINT NameType                                                                         //07-05-24|0x023c
    ) {                                                                                   //07-05-24|0x023c
//*******************************************************************************         //10-29-97|0x023c
//***************************************************************************             //07-04-27|0x0240
//***************************************************************************             //07-04-27|0x0241
  UINT command;                                                                      //07-04-27|0x0242
//***************************************************************************             //07-04-27|0x0243
//***************************************************************************             //07-04-27|0x0244
    if(dict_addr      == 0)                                 ReturnSystemError             //07-04-27|0x0245
//***************************************************************************             //07-04-27|0x0246
    switch(BaseDictInitialBridge(dict_addr, Addr, NameType))                              //07-05-24|0x0247
      {                                                                                   //07-04-27|0x0248
        case Yes:                                                      break;             //11-02-18|0x0249
        case No:                        return_no(mac_dict_initial_bridge_1);             //11-02-26|0x024a
        case UserError:                ReturnFinish("Duplicate Bridge Name");             //11-02-26|0x024b
        default:                                            ReturnSystemError             //07-04-27|0x024c
        }                                                                                 //07-04-27|0x024d
//***************************************************************************             //07-04-27|0x024e
    switch(BaseDictGetFirstCmd(dict_addr, &command))                                      //07-04-27|0x024f
      {                                                                                   //07-04-27|0x0250
        case Success:                                                  break;             //07-04-27|0x0251
        case UserError:                 return_no(mac_dict_initial_bridge_1);             //07-04-27|0x0252
        default:                                            ReturnSystemError             //07-04-27|0x0253
        }                                                                                 //07-04-27|0x0254
//---------------------------------------------------------------------------             //07-04-27|0x0255
    if(command != MC_BRIDGE_NAME)          ReturnFinish("Not A Bridge Name");             //07-04-27|0x0256
    switch(BaseDictEndEntry(dict_addr))                          _SwitchGroup             //07-04-27|0x0257
    return_yes(mac_dict_initial_bridge_2);                                                //07-04-27|0x0258
}                                                                                         //07-04-27|0x0259
//                                                                                        //05-24-97|0x0259
//***************************************************************************             //06-09-04|0x025c
//***************************************************************************             //06-09-04|0x025d
//******                                                               ******             //06-09-04|0x025e
//******               mac_dict_load_name(Name, Command)               ******             //06-09-04|0x025f
//******                                                               ******             //06-09-04|0x0260
//***************************************************************************             //06-09-04|0x0261
//***************************************************************************             //06-09-04|0x0262
//*******************************************************************************         //10-29-97|0x0267
//*******************************************************************************         //10-29-97|0x0267
// mac_dict_load_name                                                                     //06-09-04|0x0267
//*******************************************************************************         //10-29-97|0x0267
//*******************************************************************************         //10-29-97|0x0267
UINT MACDICT::mac_dict_load_name(                                                         //06-09-04|0x0267
    STRING_DATA_FAR String,                                                               //06-09-04|0x0267
    UINT Command                                                                          //06-09-04|0x0267
    ) {                                                                                   //06-09-04|0x0267
//*******************************************************************************         //10-29-97|0x0267
//***************************************************************************             //06-09-04|0x026b
//***************************************************************************             //06-09-04|0x026c
    if(dict_addr      == 0)                                 ReturnSystemError             //06-09-04|0x026d
//***************************************************************************             //06-09-04|0x026e
    switch(BaseDictBeginEntry(dict_addr, String, Command, StringType))                    //07-04-27|0x026f
      {                                                                                   //06-09-04|0x0270
        case Success:                     return_test(mac_dict_load_macro_1);             //06-09-04|0x0271
        case UserError:                                    return(UserError);             //06-09-04|0x0272
        default:                                            ReturnSystemError             //06-09-04|0x0273
        }                                                                                 //06-09-04|0x0274
}                                                                                         //06-09-04|0x0275
//                                                                                        //05-24-97|0x0275
//***************************************************************************             //06-09-04|0x0278
//***************************************************************************             //06-09-04|0x0279
//******                                                               ******             //06-09-04|0x027a
//******               mac_dict_load_command(Token, Command)           ******             //06-09-04|0x027b
//******                                                               ******             //06-09-04|0x027c
//***************************************************************************             //06-09-04|0x027d
//***************************************************************************             //06-09-04|0x027e
//*******************************************************************************         //10-29-97|0x0284
//*******************************************************************************         //10-29-97|0x0284
// mac_dict_load_command                                                                  //06-09-04|0x0284
//*******************************************************************************         //10-29-97|0x0284
//*******************************************************************************         //10-29-97|0x0284
UINT MACDICT::mac_dict_load_command(                                                      //06-09-04|0x0284
    TOKENS_FAR Token,                                                                     //06-09-04|0x0284
    UINT Command                                                                          //06-09-04|0x0284
    ) {                                                                                   //06-09-04|0x0284
//*******************************************************************************         //10-29-97|0x0284
//***************************************************************************             //06-09-04|0x0288
//***************************************************************************             //06-09-04|0x0289
  STRING_DATA_FAR Addr;                                                              //06-09-04|0x028a
  UINT token_no;                                                                     //06-09-04|0x028b
//***************************************************************************             //06-09-04|0x028c
//***************************************************************************             //06-09-04|0x028d
    if(dict_addr      == 0)                                 ReturnSystemError             //06-09-04|0x028e
    if(TokenNoTokens   < 1)                                 ReturnSystemError             //06-09-04|0x028f
    if(TokenNoTokens   > 10)                                ReturnSystemError             //06-09-04|0x0290
//***************************************************************************             //06-09-04|0x0291
    Addr = TokenTokenAddr(0);                                                             //06-09-04|0x0292
    switch(BaseDictAddNext(dict_addr, Addr, Command, AddrType))  _SwitchGroup             //07-04-27|0x0293
//***************************************************************************             //06-09-04|0x0294
    for(token_no=1; token_no<TokenNoTokens; ++token_no)                                   //06-09-04|0x0295
      {                                                                                   //06-09-04|0x0296
        TestSample(mac_dict_load_command_2);                                              //06-09-04|0x0297
        Addr = TokenTokenAddr(token_no);                                                  //06-09-04|0x0298
        switch(BaseDictAddArg(dict_addr, Addr, AddrType))                                 //07-04-27|0x0299
          {                                                                               //06-09-04|0x029a
            case Success:                                              break;             //06-09-04|0x029b
            default:                                        ReturnSystemError             //06-09-04|0x029c
            }                                                                             //06-09-04|0x029d
        }                                                                                 //06-09-04|0x029e
//***************************************************************************             //06-09-04|0x029f
    return_test(mac_dict_load_command_1);                                                 //06-09-04|0x02a0
}                                                                                         //06-09-04|0x02a1
//                                                                                        //05-24-97|0x02a1
//***************************************************************************             //06-08-18|0x02a4
//***************************************************************************             //06-08-18|0x02a5
//******                                                               ******             //06-08-18|0x02a6
//******               mac_dict_macro_end()                            ******             //06-08-18|0x02a7
//******                                                               ******             //06-08-18|0x02a8
//***************************************************************************             //06-08-18|0x02a9
//***************************************************************************             //06-08-18|0x02aa
//*******************************************************************************         //10-29-97|0x02ae
//*******************************************************************************         //10-29-97|0x02ae
// mac_dict_macro_end                                                                     //06-08-18|0x02ae
//*******************************************************************************         //10-29-97|0x02ae
//*******************************************************************************         //10-29-97|0x02ae
UINT MACDICT::mac_dict_macro_end(void) {                                                  //06-08-18|0x02ae
//*******************************************************************************         //10-29-97|0x02ae
//***************************************************************************             //06-08-18|0x02b2
//***************************************************************************             //06-08-18|0x02b3
    if(dict_addr == 0)                                      ReturnSystemError             //06-08-18|0x02b4
    switch(BaseDictEndEntry(dict_addr))                          _SwitchGroup             //06-08-18|0x02b5
//***************************************************************************             //06-08-18|0x02b6
    return_test(mac_dict_macro_end_1);                                                    //06-08-18|0x02b7
}                                                                                         //06-08-18|0x02b8
//                                                                                        //05-24-97|0x02b8
//***************************************************************************             //06-09-13|0x02bb
//***************************************************************************             //06-09-13|0x02bc
//******                                                               ******             //06-09-13|0x02bd
//******               mac_dict_find_bridge(InputString)               ******             //06-09-13|0x02be
//******                                                               ******             //06-09-13|0x02bf
//***************************************************************************             //06-09-13|0x02c0
//***************************************************************************             //06-09-13|0x02c1
//*******************************************************************************         //10-29-97|0x02c7
//*******************************************************************************         //10-29-97|0x02c7
// mac_dict_find_bridge                                                                   //07-05-24|0x02c7
//*******************************************************************************         //10-29-97|0x02c7
//*******************************************************************************         //10-29-97|0x02c7
UINT MACDICT::mac_dict_find_bridge(                                                       //07-05-24|0x02c7
    STRING_DATA_FAR Addr,                                                                 //07-05-24|0x02c7
    SINT Offset,                                                                          //07-05-24|0x02c7
    UINT BridgeType                                                                       //07-05-24|0x02c7
    ) {                                                                                   //07-05-24|0x02c7
//*******************************************************************************         //10-29-97|0x02c7
//***************************************************************************             //06-09-13|0x02cb
//***************************************************************************             //06-09-13|0x02cc
  UINT command;                                                                      //06-09-13|0x02cd
//***************************************************************************             //06-09-13|0x02ce
//***************************************************************************             //06-09-13|0x02cf
    if(dict_addr      == 0)                                 ReturnSystemError             //06-09-13|0x02d0
//***************************************************************************             //06-09-13|0x02d1
    switch(BaseDictBridge(dict_addr, Addr, Offset, BridgeType))                           //07-05-24|0x02d2
      {                                                                                   //06-09-13|0x02d3
        case Yes:                                                      break;             //11-02-26|0x02d4
        case No:                           return_no(mac_dict_find_bridge_1);             //11-02-26|0x02d5
        case UserError:                ReturnFinish("Duplicate Bridge Name");             //11-02-26|0x02d6
        default:                                            ReturnSystemError             //06-09-13|0x02d7
        }                                                                                 //06-09-13|0x02d8
//***************************************************************************             //06-09-13|0x02d9
    switch(BaseDictGetFirstCmd(dict_addr, &command))                                      //06-09-13|0x02da
      {                                                                                   //06-09-13|0x02db
        case Success:                                                  break;             //06-09-13|0x02dc
        case UserError:                ReturnFinish("Bridge Name Not Found");             //06-11-14|0x02dd
        default:                                            ReturnSystemError             //06-09-13|0x02de
        }                                                                                 //06-09-13|0x02df
//---------------------------------------------------------------------------             //06-09-13|0x02e0
    if(command != MC_BRIDGE_NAME)          ReturnFinish("Not A Bridge Name");             //07-01-23|0x02e1
    switch(BaseDictEndEntry(dict_addr))                          _SwitchGroup             //07-01-23|0x02e2
    return_yes(mac_dict_find_bridge_2);                                                   //07-04-27|0x02e3
}                                                                                         //06-09-13|0x02e4
//                                                                                        //05-24-97|0x02e4
//***************************************************************************             //07-04-27|0x02e7
//***************************************************************************             //07-04-27|0x02e8
//******                                                               ******             //07-04-27|0x02e9
//******               mac_dict_verify_class(InputString)              ******             //07-04-27|0x02ea
//******                                                               ******             //07-04-27|0x02eb
//***************************************************************************             //07-04-27|0x02ec
//***************************************************************************             //07-04-27|0x02ed
//*******************************************************************************         //10-29-97|0x02f2
//*******************************************************************************         //10-29-97|0x02f2
// mac_dict_verify_class                                                                  //07-04-27|0x02f2
//*******************************************************************************         //10-29-97|0x02f2
//*******************************************************************************         //10-29-97|0x02f2
UINT MACDICT::mac_dict_verify_class(                                                      //07-04-27|0x02f2
    STRING_DATA_FAR Addr                                                                  //07-04-27|0x02f2
    ) {                                                                                   //07-04-27|0x02f2
//*******************************************************************************         //10-29-97|0x02f2
//***************************************************************************             //07-04-27|0x02f6
//***************************************************************************             //07-04-27|0x02f7
  STRING_DATA work;                                                                  //07-04-27|0x02f8
//***************************************************************************             //07-04-27|0x02f9
//***************************************************************************             //07-04-27|0x02fa
    if(dict_addr      == 0)                                 ReturnSystemError             //07-04-27|0x02fb
//***************************************************************************             //07-04-27|0x02fc
//***************************************************************************             //07-04-28|0x02fd
    if(AddrLength >  80)   ReturnFinish("Class Name has more than 80 chars");             //07-04-28|0x02fe
//---------------------------------------------------------------------------             //07-04-28|0x02ff
    if(AddrChar(AddrLength) != 0)                          ReturnSystemError;             //07-04-28|0x0300
//***************************************************************************             //07-04-27|0x0301
    switch(MacDictGetClass(&work))                                                        //07-04-27|0x0302
      {                                                                                   //07-04-27|0x0303
        case Success:                                                  break;             //07-04-27|0x0304
        case UserError:          ReturnFinish("Class Name dictionary error");             //11-02-26|0x0305
        default:                                            ReturnSystemError             //07-04-27|0x0306
        }                                                                                 //07-04-27|0x0307
//***************************************************************************             //07-04-27|0x0308
//***************************************************************************             //07-04-27|0x0309
    if(WorkChar(WorkLength) != 0)                           ReturnSystemError             //07-04-27|0x030a
    if(AddrChar(AddrLength) != 0)                           ReturnSystemError             //07-04-27|0x030b
    switch(StrCmp(WorkLineAddr, AddrLineAddr))                                            //11-05-30|0x030c
      {                                                                                   //11-05-30|0x030d
        case 0:                         return_test(mac_dict_verify_class_1);             //11-05-30|0x030e
        case 1:                                                        break;             //11-05-30|0x030f
        case -1:                                                       break;             //11-05-30|0x0310
        default:                                            ReturnSystemError             //11-05-30|0x0311
        }                                                                                 //07-04-27|0x0312
    ReturnFinish("Incorrect Class Name");                                                 //07-04-27|0x0313
}                                                                                         //07-04-27|0x0314
//                                                                                        //05-24-97|0x0314
//***************************************************************************             //07-04-27|0x0317
//***************************************************************************             //07-04-27|0x0318
//******                                                               ******             //07-04-27|0x0319
//******               mac_dict_get_class(InputString)                 ******             //07-04-27|0x031a
//******                                                               ******             //07-04-27|0x031b
//***************************************************************************             //07-04-27|0x031c
//***************************************************************************             //07-04-27|0x031d
//*******************************************************************************         //10-29-97|0x0322
//*******************************************************************************         //10-29-97|0x0322
// mac_dict_get_class                                                                     //07-04-27|0x0322
//*******************************************************************************         //10-29-97|0x0322
//*******************************************************************************         //10-29-97|0x0322
UINT MACDICT::mac_dict_get_class(                                                         //07-04-27|0x0322
    STRING_DATA_FAR Addr                                                                  //07-04-27|0x0322
    ) {                                                                                   //07-04-27|0x0322
//*******************************************************************************         //10-29-97|0x0322
//***************************************************************************             //07-04-27|0x0326
//***************************************************************************             //07-04-27|0x0327
  UINT command;                                                                      //07-04-27|0x0328
  STRING_DATA work;                                                                  //07-04-27|0x0329
//***************************************************************************             //07-04-27|0x032a
//***************************************************************************             //07-04-27|0x032b
    if(dict_addr      == 0)                                 ReturnSystemError             //07-04-27|0x032c
//***************************************************************************             //07-04-27|0x032d
//***************************************************************************             //07-04-27|0x032e
    MemSet(&work, 0x00, sizeof(STRING_DATA));                                             //07-04-27|0x032f
    StrCpy(WorkLineAddr, "CLASS_NAME");                                                   //07-04-27|0x0330
    WorkLength  = 10;                                                                     //07-04-27|0x0331
    WorkType    = I_CLASS_NAME;                                                           //07-04-27|0x0332
    if(WorkChar(WorkLength) != 0)                          ReturnSystemError;             //07-04-27|0x0333
//***************************************************************************             //07-04-27|0x0334
    switch(BaseDictSearch(dict_addr, &work, WorkType))                                    //07-04-27|0x0335
      {                                                                                   //07-04-27|0x0336
        case Yes:                                                      break;             //07-04-27|0x0337
        case No:                                           return(UserError);             //11-02-26|0x0338
        default:                                            ReturnSystemError             //07-04-27|0x0339
        }                                                                                 //07-04-27|0x033a
//***************************************************************************             //07-04-27|0x033b
    switch(BaseDictGetFirstCmd(dict_addr, &command))                                      //07-04-27|0x033c
      {                                                                                   //07-04-27|0x033d
        case Success:                                                  break;             //07-04-27|0x033e
        case UserError:                                    return(UserError);             //07-04-27|0x033f
        default:                                            ReturnSystemError             //07-04-27|0x0340
        }                                                                                 //07-04-27|0x0341
//---------------------------------------------------------------------------             //07-04-27|0x0342
    if(command != MC_CLASS_NAME)                            ReturnSystemError             //07-04-27|0x0343
//***************************************************************************             //07-04-27|0x0344
    switch(BaseDictGetArg(dict_addr, Addr, 1))                                            //07-04-27|0x0345
      {                                                                                   //07-04-27|0x0346
        case Success:                                                  break;             //07-04-27|0x0347
        default:                                            ReturnSystemError             //07-04-27|0x0348
        }                                                                                 //07-04-27|0x0349
//---------------------------------------------------------------------------             //07-04-28|0x034a
    if(AddrType != I_CLASS_BRIDGE)                          ReturnSystemError             //07-07-17|0x034b
//---------------------------------------------------------------------------             //07-04-28|0x034c
    AddrType = I_TOKEN;                                                                   //07-07-17|0x034d
//***************************************************************************             //07-04-27|0x034e
    switch(BaseDictEndEntry(dict_addr))                          _SwitchGroup             //07-04-27|0x034f
//***************************************************************************             //07-04-28|0x0350
    return_test(mac_dict_find_name_1);                                                    //07-04-27|0x0351
}                                                                                         //07-04-27|0x0352
//                                                                                        //05-24-97|0x0352
//***************************************************************************             //11-02-26|0x0355
//***************************************************************************             //11-02-26|0x0356
//******                                                               ******             //11-02-26|0x0357
//******               mac_dict_get_cert(String)                       ******             //11-02-26|0x0358
//******                                                               ******             //11-02-26|0x0359
//***************************************************************************             //11-02-26|0x035a
//***************************************************************************             //11-02-26|0x035b
//*******************************************************************************         //10-29-97|0x0360
//*******************************************************************************         //10-29-97|0x0360
// mac_dict_get_cert                                                                      //11-02-26|0x0360
//*******************************************************************************         //10-29-97|0x0360
//*******************************************************************************         //10-29-97|0x0360
UINT MACDICT::mac_dict_get_cert(                                                          //11-02-26|0x0360
    STRING_DATA_FAR Addr                                                                  //11-02-26|0x0360
    ) {                                                                                   //11-02-26|0x0360
//*******************************************************************************         //10-29-97|0x0360
//***************************************************************************             //11-02-26|0x0364
//***************************************************************************             //11-02-26|0x0365
    if(dict_addr      == 0)                                 ReturnSystemError             //11-02-26|0x0366
//***************************************************************************             //11-02-26|0x0367
//***************************************************************************             //11-02-26|0x0368
    switch(BaseDictGetCert(dict_addr, Addr))                     _SwitchGroup             //11-02-26|0x0369
//***************************************************************************             //11-02-26|0x036a
    return_test(mac_dict_get_cert_1);                                                     //11-02-26|0x036b
}                                                                                         //11-02-26|0x036c
//                                                                                        //05-24-97|0x036c
//***************************************************************************             //07-05-24|0x036f
//***************************************************************************             //07-05-24|0x0370
//******                                                               ******             //07-05-24|0x0371
//******             mac_dict_check_dup_name(InputString, Type)        ******             //07-05-24|0x0372
//******                                                               ******             //07-05-24|0x0373
//***************************************************************************             //07-05-24|0x0374
//***************************************************************************             //07-05-24|0x0375
//*******************************************************************************         //10-29-97|0x037b
//*******************************************************************************         //10-29-97|0x037b
// mac_dict_check_dup_name                                                                //07-05-24|0x037b
//*******************************************************************************         //10-29-97|0x037b
//*******************************************************************************         //10-29-97|0x037b
UINT MACDICT::mac_dict_check_dup_name(                                                    //07-05-24|0x037b
    STRING_DATA_FAR Addr,                                                                 //07-05-24|0x037b
    UINT BridgeType                                                                       //07-05-24|0x037b
    ) {                                                                                   //07-05-24|0x037b
//*******************************************************************************         //10-29-97|0x037b
//***************************************************************************             //07-05-24|0x037f
//***************************************************************************             //07-05-24|0x0380
    if(dict_addr      == 0)                                 ReturnSystemError             //07-05-24|0x0381
//***************************************************************************             //07-05-24|0x0382
    switch(BaseDictSearch(dict_addr, Addr, BridgeType))                                   //07-05-24|0x0383
      {                                                                                   //07-05-24|0x0384
        case Yes:                      return_yes(mac_dict_check_dup_name_1);             //07-05-24|0x0385
        case No:                       return_no(mac_dict_check_dup_name_2);              //07-05-24|0x0386
        case UserError:                                    return(UserError);             //07-05-24|0x0387
        default:                                            ReturnSystemError             //07-05-24|0x0388
        }                                                                                 //07-05-24|0x0389
}                                                                                         //07-05-24|0x038a
//                                                                                        //05-24-97|0x038a
//***************************************************************************             //06-09-26|0x038d
//***************************************************************************             //06-09-26|0x038e
//******                                                               ******             //06-09-26|0x038f
//******               mac_dict_find_name(InputString, Command)        ******             //06-09-26|0x0390
//******                                                               ******             //06-09-26|0x0391
//***************************************************************************             //06-09-26|0x0392
//***************************************************************************             //06-09-26|0x0393
//*******************************************************************************         //10-29-97|0x0398
//*******************************************************************************         //10-29-97|0x0398
// mac_dict_find_name                                                                     //06-09-26|0x0398
//*******************************************************************************         //10-29-97|0x0398
//*******************************************************************************         //10-29-97|0x0398
UINT MACDICT::mac_dict_find_name(                                                         //06-09-26|0x0398
    STRING_DATA_FAR Addr,                                                                 //06-09-26|0x0398
    UINT Command                                                                          //06-09-26|0x0398
    ) {                                                                                   //06-09-26|0x0398
//*******************************************************************************         //10-29-97|0x0398
//***************************************************************************             //06-09-26|0x039c
//***************************************************************************             //06-09-26|0x039d
  UINT command;                                                                      //06-09-26|0x039e
//***************************************************************************             //06-09-26|0x039f
//***************************************************************************             //06-09-26|0x03a0
    if(dict_addr      == 0)                                 ReturnSystemError             //06-09-26|0x03a1
//***************************************************************************             //06-09-26|0x03a2
    switch(BaseDictSearch(dict_addr, Addr, AddrType))                                     //07-04-27|0x03a3
      {                                                                                   //06-09-26|0x03a4
        case Yes:                                                      break;             //06-09-26|0x03a5
        case No:                                           return(UserError);             //06-09-26|0x03a6
        default:                                            ReturnSystemError             //06-09-26|0x03a7
        }                                                                                 //06-09-26|0x03a8
//***************************************************************************             //06-09-26|0x03a9
    switch(BaseDictGetFirstCmd(dict_addr, &command))                                      //06-09-26|0x03aa
      {                                                                                   //06-09-26|0x03ab
        case Success:                                                  break;             //06-09-26|0x03ac
        case UserError:                                    return(UserError);             //06-11-14|0x03ad
        default:                                            ReturnSystemError             //06-09-26|0x03ae
        }                                                                                 //06-09-26|0x03af
//---------------------------------------------------------------------------             //06-09-26|0x03b0
    if(command == Command)                 return_test(mac_dict_find_name_1);             //06-09-26|0x03b1
    ReturnSystemError                                                                     //06-09-26|0x03b2
}                                                                                         //06-09-26|0x03b3
//                                                                                        //05-24-97|0x03b3
//***************************************************************************             //06-11-14|0x03b6
//***************************************************************************             //06-11-14|0x03b7
//******                                                               ******             //06-11-14|0x03b8
//******               mac_dict_get_command(Token, CommandAddr)        ******             //06-11-14|0x03b9
//******                                                               ******             //06-11-14|0x03ba
//***************************************************************************             //06-11-14|0x03bb
//***************************************************************************             //06-11-14|0x03bc
//*******************************************************************************         //10-29-97|0x03c2
//*******************************************************************************         //10-29-97|0x03c2
// mac_dict_get_command                                                                   //06-11-14|0x03c2
//*******************************************************************************         //10-29-97|0x03c2
//*******************************************************************************         //10-29-97|0x03c2
UINT MACDICT::mac_dict_get_command(                                                       //06-11-14|0x03c2
    TOKENS_FAR Token,                                                                     //06-11-14|0x03c2
    UINT_FAR CommandFar                                                                   //06-11-14|0x03c2
    ) {                                                                                   //06-11-14|0x03c2
//*******************************************************************************         //10-29-97|0x03c2
//***************************************************************************             //06-11-14|0x03c6
//***************************************************************************             //06-11-14|0x03c7
  STRING_DATA_FAR addr;                                                              //06-11-14|0x03c8
//***************************************************************************             //06-11-14|0x03c9
//***************************************************************************             //06-11-14|0x03ca
    if(dict_addr      == 0)                                 ReturnSystemError             //06-11-14|0x03cb
    if(TokenNoTokens  != 0)                                 ReturnSystemError             //06-11-14|0x03cc
//***************************************************************************             //06-11-14|0x03cd
    switch(BaseDictGetNextCmd(dict_addr, CommandFar))                                     //06-11-14|0x03ce
      {                                                                                   //06-11-14|0x03cf
        case Success:                                                  break;             //06-11-14|0x03d0
        default:                                            ReturnSystemError             //06-11-14|0x03d1
        }                                                                                 //06-11-14|0x03d2
//***************************************************************************             //06-11-14|0x03d3
loop:                                                                                     //06-11-14|0x03d4
    if(TokenNoTokens  > 10)                                 ReturnSystemError             //07-01-24|0x03d5
    switch(BaseDictTestArg(dict_addr, TokenNoTokens))                                     //07-01-24|0x03d6
      {                                                                                   //07-01-24|0x03d7
        case No:                         return_test(mac_dict_get_command_1);             //07-01-24|0x03d8
        case Yes:                                                      break;             //07-01-24|0x03d9
        default:                                            ReturnSystemError             //07-01-24|0x03da
        }                                                                                 //07-01-24|0x03db
//---------------------------------------------------------------------------             //07-01-24|0x03dc
    addr = TokenTokenAddr(TokenNoTokens);                                                 //07-01-24|0x03dd
    switch(BaseDictGetArg(dict_addr, addr, TokenNoTokens))                                //07-01-24|0x03de
      {                                                                                   //07-01-24|0x03df
        case Success:   ++TokenNoTokens;                           goto loop;             //07-01-24|0x03e0
        default:                                            ReturnSystemError             //07-01-24|0x03e1
        }                                                                                 //07-01-24|0x03e2
}                                                                                         //06-11-14|0x03e3
//                                                                                        //05-24-97|0x03e3
//***************************************************************************             //06-07-14|0x03e6
//***************************************************************************             //06-07-14|0x03e7
//******                                                               ******             //06-07-14|0x03e8
//******                       TEST WRAPPERS                           ******             //06-07-14|0x03e9
//******                                                               ******             //06-07-14|0x03ea
//***************************************************************************             //06-07-14|0x03eb
//***************************************************************************             //06-07-14|0x03ec
//*******************************************************************************         //10-29-97|0x03ed
//*******************************************************************************         //10-29-97|0x03ed
// macdict_test_reset                                                                     //06-07-14|0x03ed
//*******************************************************************************         //10-29-97|0x03ed
//*******************************************************************************         //10-29-97|0x03ed
UINT MACDICT::macdict_test_reset(void) {                                                  //06-07-14|0x03ed
//*******************************************************************************         //10-29-97|0x03ed
//************************************************************************                //06-07-14|0x03ed
    switch(BasicTestReset())                                                              //06-07-14|0x03ed
      {                                                                                   //06-07-14|0x03ed
        case Success:                                     return(Success);                //06-07-14|0x03ed
        default:                                        ReturnSystemError;                //06-07-14|0x03ed
        }                                                                                 //06-07-14|0x03ed
}                                                                                         //06-07-14|0x03ed
//                                                                                        //05-24-97|0x03ed
//***************************************************************************             //06-07-14|0x03ee
//*******************************************************************************         //10-29-97|0x03ef
//*******************************************************************************         //10-29-97|0x03ef
// macdict_test_read                                                                      //06-07-14|0x03ef
//*******************************************************************************         //10-29-97|0x03ef
//*******************************************************************************         //10-29-97|0x03ef
UINT MACDICT::macdict_test_read(void) {                                                   //06-07-14|0x03ef
//*******************************************************************************         //10-29-97|0x03ef
//************************************************************************                //06-07-14|0x03ef
    switch(BasicTestRead(&test_samples[0], test_samples[0]))                              //06-07-14|0x03ef
      {                                                                                   //06-07-14|0x03ef
        case Success:                                     return(Success);                //06-07-14|0x03ef
        default:                                        ReturnSystemError;                //06-07-14|0x03ef
        }                                                                                 //06-07-14|0x03ef
}                                                                                         //06-07-14|0x03ef
//                                                                                        //05-24-97|0x03ef
//***************************************************************************             //06-07-14|0x03f0
//*******************************************************************************         //10-29-97|0x03f1
//*******************************************************************************         //10-29-97|0x03f1
// macdict_test_write                                                                     //06-07-14|0x03f1
//*******************************************************************************         //10-29-97|0x03f1
//*******************************************************************************         //10-29-97|0x03f1
UINT MACDICT::macdict_test_write(void) {                                                  //06-07-14|0x03f1
//*******************************************************************************         //10-29-97|0x03f1
//************************************************************************                //06-07-14|0x03f1
    switch(BasicTestWrite(&test_samples[0]))                                              //06-07-14|0x03f1
      {                                                                                   //06-07-14|0x03f1
        case Success:                                     return(Success);                //06-07-14|0x03f1
        default:                                        ReturnSystemError;                //06-07-14|0x03f1
        }                                                                                 //06-07-14|0x03f1
}                                                                                         //06-07-14|0x03f1
//                                                                                        //05-24-97|0x03f1
//***************************************************************************             //06-07-14|0x03f2
//*******************************************************************************         //10-29-97|0x03f3
//*******************************************************************************         //10-29-97|0x03f3
// macdict_test_report                                                                    //06-07-14|0x03f3
//*******************************************************************************         //10-29-97|0x03f3
//*******************************************************************************         //10-29-97|0x03f3
UINT MACDICT::macdict_test_report(void) {                                                 //06-07-14|0x03f3
//*******************************************************************************         //10-29-97|0x03f3
//************************************************************************                //06-07-14|0x03f3
    switch(BasicTestReport(&test_samples[0], "MACDICT"))                                  //06-07-14|0x03f3
      {                                                                                   //06-07-14|0x03f3
        case Success:                                     return(Success);                //06-07-14|0x03f3
        default:                                        ReturnSystemError;                //06-07-14|0x03f3
        }                                                                                 //06-07-14|0x03f3
}                                                                                         //06-07-14|0x03f3
//                                                                                        //05-24-97|0x03f3
//***************************************************************************             //06-07-12|0x03f6
//***************************************************************************             //06-07-12|0x03f7
//******                                                               ******             //06-07-12|0x03f8
//******                        constructor                            ******             //06-07-12|0x03f9
//******                                                               ******             //06-07-12|0x03fa
//***************************************************************************             //06-07-12|0x03fb
//***************************************************************************             //06-07-12|0x03fc
//*******************************************************************************         //10-29-97|0x03fd
//*******************************************************************************         //10-29-97|0x03fd
// CONSTRUCTOR                                                                            //04-01-97|0x03fd
//*******************************************************************************         //10-29-97|0x03fd
//*******************************************************************************         //10-29-97|0x03fd
MACDICT::MACDICT() {                                                                      //04-01-97|0x03fd
//***************************************************************************             //06-07-12|0x03fe
//***************************************************************************             //06-07-12|0x03ff
    { ULONG i;                                                                            //06-07-12|0x0400
      test_samples[NoTestSamples] = TestIndex;                                            //06-07-12|0x0400
      i = 1;                                                                              //06-07-12|0x0400
      while(i<TestIndex)                                                                  //06-07-12|0x0400
        {                                                                                 //06-07-12|0x0400
          test_samples[i] = 0;                                                            //06-07-12|0x0400
          ++i;                                                                            //06-07-12|0x0400
          }                                                                               //06-07-12|0x0400
      }                                                                                   //06-07-12|0x0400
//***************************************************************************             //06-07-12|0x0401
}                                                                                         //98-03-28|0x0402
//                                                                                        //05-24-97|0x0402
//*******************************************************************************         //05-24-97|0x0406
//*******************************************************************************         //05-24-97|0x0406
//****                       END OF FILE                                     ****         //05-24-97|0x0406
//*******************************************************************************         //05-24-97|0x0406
//*******************************************************************************         //05-24-97|0x0406
